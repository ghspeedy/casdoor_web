var u=Object.defineProperty;var x=(s,n,e)=>n in s?u(s,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[n]=e;var c=(s,n,e)=>(x(s,typeof n!="symbol"?n+"":n,e),e);import{g as f,s as l,i as t,b as y,j as d,L as g,c as w,e as k,f as m,B as p,k as $}from"./index-a4571b31.js";import{h as C}from"./moment-fbc5633a.js";import{b as M,d as S,g as b}from"./ModelBackend-832b6120.js";import{B as T}from"./BaseListPage-cf3b6a63.js";import{P as F}from"./PopconfirmModal-c2d7912b.js";import{S as N}from"./index-c1f94e42.js";import{T as P}from"./Table-4974f722.js";import"./index-3220aa08.js";class A extends T{constructor(){super(...arguments);c(this,"fetch",(e={})=>{let a=e.searchedColumn,h=e.searchText;const r=e.sortField,o=e.sortOrder;e.type!==void 0&&e.type!==null&&(a="type",h=e.type),this.setState({loading:!0}),b("",e.pagination.current,e.pagination.pageSize,a,h,r,o).then(i=>{i.status==="ok"?this.setState({loading:!1,data:i.data,pagination:{...e.pagination,total:i.data2},searchText:e.searchText,searchedColumn:e.searchedColumn}):$(i)&&this.setState({loading:!1,isAuthorized:!1})})})}newModel(){const e=f();return{owner:"built-in",name:`model_${e}`,createdTime:C().format(),displayName:`New Model - ${e}`,modelText:"",isEnabled:!0}}addModel(){const e=this.newModel();M(e).then(a=>{a.status==="ok"?(this.props.history.push({pathname:`/models/${e.owner}/${e.name}`,mode:"add"}),l("success",t.t("general:Successfully added"))):l("error",`${t.t("general:Failed to add")}: ${a.msg}`)}).catch(a=>{l("error",`${t.t("general:Failed to connect to server")}: ${a}`)})}deleteModel(e){S(this.state.data[e]).then(a=>{a.status==="ok"?(l("success",t.t("general:Successfully deleted")),this.setState({data:y(this.state.data,e),pagination:{total:this.state.pagination.total-1}})):l("error",`${t.t("general:Failed to delete")}: ${a.msg}`)}).catch(a=>{l("error",`${t.t("general:Failed to connect to server")}: ${a}`)})}renderTable(e){const a=[{title:t.t("general:Name"),dataIndex:"name",key:"name",width:"150px",fixed:"left",sorter:!0,...this.getColumnSearchProps("name"),render:(r,o,i)=>d(g,{to:`/models/${o.owner}/${r}`,children:r})},{title:t.t("general:Organization"),dataIndex:"owner",key:"owner",width:"120px",sorter:!0,...this.getColumnSearchProps("owner"),render:(r,o,i)=>d(g,{to:`/organizations/${r}`,children:r})},{title:t.t("general:Created time"),dataIndex:"createdTime",key:"createdTime",width:"160px",sorter:!0,render:(r,o,i)=>w(r)},{title:t.t("general:Display name"),dataIndex:"displayName",key:"displayName",width:"200px",sorter:!0,...this.getColumnSearchProps("displayName")},{title:t.t("general:Is enabled"),dataIndex:"isEnabled",key:"isEnabled",width:"120px",sorter:!0,render:(r,o,i)=>d(N,{disabled:!0,checkedChildren:"ON",unCheckedChildren:"OFF",checked:r})},{title:t.t("general:Action"),dataIndex:"",key:"op",width:"170px",fixed:k()?"false":"right",render:(r,o,i)=>m("div",{children:[d(p,{style:{marginTop:"10px",marginBottom:"10px",marginRight:"10px"},type:"primary",onClick:()=>this.props.history.push(`/models/${o.owner}/${o.name}`),children:t.t("general:Edit")}),d(F,{title:t.t("general:Sure to delete")+`: ${o.name} ?`,onConfirm:()=>this.deleteModel(i)})]})}],h={total:this.state.pagination.total,showQuickJumper:!0,showSizeChanger:!0,showTotal:()=>t.t("general:{total} in total").replace("{total}",this.state.pagination.total)};return d("div",{children:d(P,{scroll:{x:"max-content"},columns:a,dataSource:e,rowKey:"name",size:"middle",bordered:!0,pagination:h,title:()=>m("div",{children:[t.t("general:Models"),"    ",d(p,{type:"primary",size:"small",onClick:this.addModel.bind(this),children:t.t("general:Add")})]}),loading:this.state.loading,onChange:this.handleTableChange})})}}export{A as default};
