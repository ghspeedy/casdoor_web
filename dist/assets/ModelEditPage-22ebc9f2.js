import{R as c,h as u,f as l,w as M,i as t,j as a,B as o,e as d,n as r,o as i,x as m,r as p,I as g,dC as y,F as x,s as h,X as v}from"./index-a4571b31.js";import{a as T,g as f,u as C,d as N}from"./ModelBackend-832b6120.js";import{S as z}from"./index-c1f94e42.js";const{Option:F}=p;class $ extends c.Component{constructor(e){super(e),this.state={classes:e,organizationName:e.organizationName!==void 0?e.organizationName:e.match.params.organizationName,modelName:e.match.params.modelName,model:null,organizations:[],users:[],models:[],mode:e.location.mode!==void 0?e.location.mode:"edit"}}UNSAFE_componentWillMount(){this.getModel(),this.getOrganizations()}getModel(){T(this.state.organizationName,this.state.modelName).then(e=>{this.setState({model:e}),this.getModels(e.owner)})}getOrganizations(){u("admin").then(e=>{this.setState({organizations:e.msg===void 0?e:[]})})}getModels(e){f(e).then(s=>{this.setState({models:s})})}parseModelField(e,s){return[""].includes(e)&&(s=v(s)),s}updateModelField(e,s){s=this.parseModelField(e,s);const n=this.state.model;n[e]=s,this.setState({model:n})}renderModel(){return l(M,{size:"small",title:l("div",{children:[this.state.mode==="add"?t.t("model:New Model"):t.t("model:Edit Model"),"    ",a(o,{onClick:()=>this.submitModelEdit(!1),children:t.t("general:Save")}),a(o,{style:{marginLeft:"20px"},type:"primary",onClick:()=>this.submitModelEdit(!0),children:t.t("general:Save & Exit")}),this.state.mode==="add"?a(o,{style:{marginLeft:"20px"},onClick:()=>this.deleteModel(),children:t.t("general:Cancel")}):null]}),style:d()?{margin:"5px"}:{},type:"inner",children:[l(r,{style:{marginTop:"10px"},children:[l(i,{style:{marginTop:"5px"},span:d()?22:2,children:[m(t.t("general:Organization"),t.t("general:Organization - Tooltip"))," :"]}),a(i,{span:22,children:a(p,{virtual:!1,style:{width:"100%"},value:this.state.model.owner,onChange:e=>{this.updateModelField("owner",e)},children:this.state.organizations.map((e,s)=>a(F,{value:e.name,children:e.name},s))})})]}),l(r,{style:{marginTop:"20px"},children:[l(i,{style:{marginTop:"5px"},span:d()?22:2,children:[m(t.t("general:Name"),t.t("general:Name - Tooltip"))," :"]}),a(i,{span:22,children:a(g,{value:this.state.model.name,onChange:e=>{this.updateModelField("name",e.target.value)}})})]}),l(r,{style:{marginTop:"20px"},children:[l(i,{style:{marginTop:"5px"},span:d()?22:2,children:[m(t.t("general:Display name"),t.t("general:Display name - Tooltip"))," :"]}),a(i,{span:22,children:a(g,{value:this.state.model.displayName,onChange:e=>{this.updateModelField("displayName",e.target.value)}})})]}),l(r,{style:{marginTop:"20px"},children:[l(i,{style:{marginTop:"5px"},span:d()?22:2,children:[m(t.t("model:Model text"),t.t("model:Model text - Tooltip"))," :"]}),a(i,{span:22,children:a(y,{rows:10,value:this.state.model.modelText,onChange:e=>{this.updateModelField("modelText",e.target.value)}})})]}),l(r,{style:{marginTop:"20px"},children:[l(i,{style:{marginTop:"5px"},span:d()?19:2,children:[m(t.t("general:Is enabled"),t.t("general:Is enabled - Tooltip"))," :"]}),a(i,{span:1,children:a(z,{checked:this.state.model.isEnabled,onChange:e=>{this.updateModelField("isEnabled",e)}})})]})]})}submitModelEdit(e){const s=x(this.state.model);C(this.state.organizationName,this.state.modelName,s).then(n=>{n.status==="ok"?(h("success",t.t("general:Successfully saved")),this.setState({modelName:this.state.model.name}),e?this.props.history.push("/models"):this.props.history.push(`/models/${this.state.model.owner}/${this.state.model.name}`)):(h("error",`${t.t("general:Failed to save")}: ${n.msg}`),this.updateModelField("name",this.state.modelName))}).catch(n=>{h("error",`${t.t("general:Failed to connect to server")}: ${n}`)})}deleteModel(){N(this.state.model).then(e=>{e.status==="ok"?this.props.history.push("/models"):h("error",`${t.t("general:Failed to delete")}: ${e.msg}`)}).catch(e=>{h("error",`${t.t("general:Failed to connect to server")}: ${e}`)})}render(){return l("div",{children:[this.state.model!==null?this.renderModel():null,l("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[a(o,{size:"large",onClick:()=>this.submitModelEdit(!1),children:t.t("general:Save")}),a(o,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:()=>this.submitModelEdit(!0),children:t.t("general:Save & Exit")}),this.state.mode==="add"?a(o,{style:{marginLeft:"20px"},size:"large",onClick:()=>this.deleteModel(),children:t.t("general:Cancel")}):null]})]})}}export{$ as default};
