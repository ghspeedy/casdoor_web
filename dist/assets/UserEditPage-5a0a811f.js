var ei=Object.defineProperty;var ti=(a,e,t)=>e in a?ei(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var ve=(a,e,t)=>(ti(a,typeof e!="symbol"?e+"":e,t),t);import{ah as V,ai as Nt,aj as Ae,R as I,f as m,j as d,B as W,bO as Ke,i as p,o as v,n as E,r as re,s as X,P as _e,I as Y,b_ as ii,aa as ai,b$ as ri,c0 as ni,c1 as si,c2 as oi,e as O,b as Ze,c3 as hi,F as kt,l as zt,q as ht,T as Pe,D as li,c4 as ci,h as di,v as pi,c5 as ui,x as N,y as Ue,Z as lt,a8 as fi,c6 as gi,c7 as mi,O as vi,W as ct,c8 as yi,c9 as wi,w as xi,ca as bi,M as Ti,bN as Ci,at as Di}from"./index-a4571b31.js";import{g as Oi,u as Ei}from"./ResourceBackend-5971129e.js";import{T as Qe}from"./Table-4974f722.js";import{U as Mi}from"./UpOutlined-fd61f12a.js";import{D as Pt}from"./DeleteOutlined-4c84e7f6.js";import{S as Ee}from"./index-c1f94e42.js";import"./UpOutlined-7082c42f.js";import"./DeleteOutlined-25685737.js";var Si={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"};const Ai=Si;var Ri={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M877.1 238.7L770.6 132.3c-13-13-30.4-20.3-48.8-20.3s-35.8 7.2-48.8 20.3L558.3 246.8c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l89.6 89.7a405.46 405.46 0 01-86.4 127.3c-36.7 36.9-79.6 66-127.2 86.6l-89.6-89.7c-13-13-30.4-20.3-48.8-20.3a68.2 68.2 0 00-48.8 20.3L132.3 673c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l106.4 106.4c22.2 22.2 52.8 34.9 84.2 34.9 6.5 0 12.8-.5 19.2-1.6 132.4-21.8 263.8-92.3 369.9-198.3C818 606 888.4 474.6 910.4 342.1c6.3-37.6-6.3-76.3-33.3-103.4zm-37.6 91.5c-19.5 117.9-82.9 235.5-178.4 331s-213 158.9-330.9 178.4c-14.8 2.5-30-2.5-40.8-13.2L184.9 721.9 295.7 611l119.8 120 .9.9 21.6-8a481.29 481.29 0 00285.7-285.8l8-21.6-120.8-120.7 110.8-110.9 104.5 104.5c10.8 10.8 15.8 26 13.3 40.8z"}}]},name:"phone",theme:"outlined"};const Ni=Ri;var Ut=function(e,t){return V.createElement(Nt,Ae(Ae({},e),{},{ref:t,icon:Ai}))};Ut.displayName="MailOutlined";const ki=V.forwardRef(Ut);var Bt=function(e,t){return V.createElement(Nt,Ae(Ae({},e),{},{ref:t,icon:Ni}))};Bt.displayName="PhoneOutlined";const zi=V.forwardRef(Bt);/*!
 * Cropper.js v1.5.13
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2022-11-20T05:30:46.114Z
 */function dt(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),t.push.apply(t,i)}return t}function Lt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dt(Object(t),!0).forEach(function(i){Bi(a,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):dt(Object(t)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(t,i))})}return a}function We(a){return We=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(a)}function Pi(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function pt(a,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}function Ui(a,e,t){return e&&pt(a.prototype,e),t&&pt(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function Bi(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function It(a){return Li(a)||Ii(a)||_i(a)||Wi()}function Li(a){if(Array.isArray(a))return He(a)}function Ii(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function _i(a,e){if(a){if(typeof a=="string")return He(a,e);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return He(a,e)}}function He(a,e){(e==null||e>a.length)&&(e=a.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=a[t];return i}function Wi(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ke=typeof window<"u"&&typeof window.document<"u",te=ke?window:{},Je=ke&&te.document.documentElement?"ontouchstart"in te.document.documentElement:!1,et=ke?"PointerEvent"in te:!1,z="cropper",tt="all",_t="crop",Wt="move",Ht="zoom",he="e",le="w",pe="s",ie="n",ye="ne",we="nw",xe="se",be="sw",Ye="".concat(z,"-crop"),ut="".concat(z,"-disabled"),K="".concat(z,"-hidden"),ft="".concat(z,"-hide"),Hi="".concat(z,"-invisible"),Re="".concat(z,"-modal"),Xe="".concat(z,"-move"),De="".concat(z,"Action"),Me="".concat(z,"Preview"),it="crop",Yt="move",Xt="none",Fe="crop",je="cropend",$e="cropmove",Ve="cropstart",gt="dblclick",Yi=Je?"touchstart":"mousedown",Xi=Je?"touchmove":"mousemove",Fi=Je?"touchend touchcancel":"mouseup",mt=et?"pointerdown":Yi,vt=et?"pointermove":Xi,yt=et?"pointerup pointercancel":Fi,wt="ready",xt="resize",bt="wheel",Ge="zoom",Tt="image/jpeg",ji=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,$i=/^data:/,Vi=/^data:image\/jpeg;base64,/,Gi=/^img|canvas$/i,Ft=200,jt=100,Ct={viewMode:0,dragMode:it,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Ft,minContainerHeight:jt,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},qi='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',Ki=Number.isNaN||te.isNaN;function M(a){return typeof a=="number"&&!Ki(a)}var Dt=function(e){return e>0&&e<1/0};function Be(a){return typeof a>"u"}function ce(a){return We(a)==="object"&&a!==null}var Zi=Object.prototype.hasOwnProperty;function ue(a){if(!ce(a))return!1;try{var e=a.constructor,t=e.prototype;return e&&t&&Zi.call(t,"isPrototypeOf")}catch{return!1}}function q(a){return typeof a=="function"}var Qi=Array.prototype.slice;function $t(a){return Array.from?Array.from(a):Qi.call(a)}function H(a,e){return a&&q(e)&&(Array.isArray(a)||M(a.length)?$t(a).forEach(function(t,i){e.call(a,t,i,a)}):ce(a)&&Object.keys(a).forEach(function(t){e.call(a,a[t],t,a)})),a}var P=Object.assign||function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return ce(e)&&i.length>0&&i.forEach(function(r){ce(r)&&Object.keys(r).forEach(function(s){e[s]=r[s]})}),e},Ji=/\.\d*(?:0|9){12}\d*$/;function ge(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Ji.test(a)?Math.round(a*e)/e:a}var ea=/^width|height|left|top|marginLeft|marginTop$/;function ne(a,e){var t=a.style;H(e,function(i,n){ea.test(n)&&M(i)&&(i="".concat(i,"px")),t[n]=i})}function ta(a,e){return a.classList?a.classList.contains(e):a.className.indexOf(e)>-1}function j(a,e){if(e){if(M(a.length)){H(a,function(i){j(i,e)});return}if(a.classList){a.classList.add(e);return}var t=a.className.trim();t?t.indexOf(e)<0&&(a.className="".concat(t," ").concat(e)):a.className=e}}function ee(a,e){if(e){if(M(a.length)){H(a,function(t){ee(t,e)});return}if(a.classList){a.classList.remove(e);return}a.className.indexOf(e)>=0&&(a.className=a.className.replace(e,""))}}function fe(a,e,t){if(e){if(M(a.length)){H(a,function(i){fe(i,e,t)});return}t?j(a,e):ee(a,e)}}var ia=/([a-z\d])([A-Z])/g;function at(a){return a.replace(ia,"$1-$2").toLowerCase()}function qe(a,e){return ce(a[e])?a[e]:a.dataset?a.dataset[e]:a.getAttribute("data-".concat(at(e)))}function Oe(a,e,t){ce(t)?a[e]=t:a.dataset?a.dataset[e]=t:a.setAttribute("data-".concat(at(e)),t)}function aa(a,e){if(ce(a[e]))try{delete a[e]}catch{a[e]=void 0}else if(a.dataset)try{delete a.dataset[e]}catch{a.dataset[e]=void 0}else a.removeAttribute("data-".concat(at(e)))}var Vt=/\s\s*/,Gt=function(){var a=!1;if(ke){var e=!1,t=function(){},i=Object.defineProperty({},"once",{get:function(){return a=!0,e},set:function(r){e=r}});te.addEventListener("test",t,i),te.removeEventListener("test",t,i)}return a}();function Q(a,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=t;e.trim().split(Vt).forEach(function(r){if(!Gt){var s=a.listeners;s&&s[r]&&s[r][t]&&(n=s[r][t],delete s[r][t],Object.keys(s[r]).length===0&&delete s[r],Object.keys(s).length===0&&delete a.listeners)}a.removeEventListener(r,n,i)})}function Z(a,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=t;e.trim().split(Vt).forEach(function(r){if(i.once&&!Gt){var s=a.listeners,h=s===void 0?{}:s;n=function(){delete h[r][t],a.removeEventListener(r,n,i);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];t.apply(a,l)},h[r]||(h[r]={}),h[r][t]&&a.removeEventListener(r,h[r][t],i),h[r][t]=n,a.listeners=h}a.addEventListener(r,n,i)})}function me(a,e,t){var i;return q(Event)&&q(CustomEvent)?i=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent"),i.initCustomEvent(e,!0,!0,t)),a.dispatchEvent(i)}function qt(a){var e=a.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Le=te.location,ra=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ot(a){var e=a.match(ra);return e!==null&&(e[1]!==Le.protocol||e[2]!==Le.hostname||e[3]!==Le.port)}function Et(a){var e="timestamp=".concat(new Date().getTime());return a+(a.indexOf("?")===-1?"?":"&")+e}function Ce(a){var e=a.rotate,t=a.scaleX,i=a.scaleY,n=a.translateX,r=a.translateY,s=[];M(n)&&n!==0&&s.push("translateX(".concat(n,"px)")),M(r)&&r!==0&&s.push("translateY(".concat(r,"px)")),M(e)&&e!==0&&s.push("rotate(".concat(e,"deg)")),M(t)&&t!==1&&s.push("scaleX(".concat(t,")")),M(i)&&i!==1&&s.push("scaleY(".concat(i,")"));var h=s.length?s.join(" "):"none";return{WebkitTransform:h,msTransform:h,transform:h}}function na(a){var e=Lt({},a),t=0;return H(a,function(i,n){delete e[n],H(e,function(r){var s=Math.abs(i.startX-r.startX),h=Math.abs(i.startY-r.startY),u=Math.abs(i.endX-r.endX),o=Math.abs(i.endY-r.endY),l=Math.sqrt(s*s+h*h),c=Math.sqrt(u*u+o*o),f=(c-l)/l;Math.abs(f)>Math.abs(t)&&(t=f)})}),t}function Se(a,e){var t=a.pageX,i=a.pageY,n={endX:t,endY:i};return e?n:Lt({startX:t,startY:i},n)}function sa(a){var e=0,t=0,i=0;return H(a,function(n){var r=n.startX,s=n.startY;e+=r,t+=s,i+=1}),e/=i,t/=i,{pageX:e,pageY:t}}function se(a){var e=a.aspectRatio,t=a.height,i=a.width,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",r=Dt(i),s=Dt(t);if(r&&s){var h=t*e;n==="contain"&&h>i||n==="cover"&&h<i?t=i/e:i=t*e}else r?t=i/e:s&&(i=t*e);return{width:i,height:t}}function oa(a){var e=a.width,t=a.height,i=a.degree;if(i=Math.abs(i)%180,i===90)return{width:t,height:e};var n=i%90*Math.PI/180,r=Math.sin(n),s=Math.cos(n),h=e*s+t*r,u=e*r+t*s;return i>90?{width:u,height:h}:{width:h,height:u}}function ha(a,e,t,i){var n=e.aspectRatio,r=e.naturalWidth,s=e.naturalHeight,h=e.rotate,u=h===void 0?0:h,o=e.scaleX,l=o===void 0?1:o,c=e.scaleY,f=c===void 0?1:c,x=t.aspectRatio,y=t.naturalWidth,S=t.naturalHeight,b=i.fillColor,C=b===void 0?"transparent":b,U=i.imageSmoothingEnabled,k=U===void 0?!0:U,L=i.imageSmoothingQuality,$=L===void 0?"low":L,g=i.maxWidth,w=g===void 0?1/0:g,D=i.maxHeight,A=D===void 0?1/0:D,T=i.minWidth,B=T===void 0?0:T,R=i.minHeight,_=R===void 0?0:R,G=document.createElement("canvas"),F=G.getContext("2d"),J=se({aspectRatio:x,width:w,height:A}),oe=se({aspectRatio:x,width:B,height:_},"cover"),de=Math.min(J.width,Math.max(oe.width,y)),ze=Math.min(J.height,Math.max(oe.height,S)),rt=se({aspectRatio:n,width:w,height:A}),nt=se({aspectRatio:n,width:B,height:_},"cover"),st=Math.min(rt.width,Math.max(nt.width,r)),ot=Math.min(rt.height,Math.max(nt.height,s)),Qt=[-st/2,-ot/2,st,ot];return G.width=ge(de),G.height=ge(ze),F.fillStyle=C,F.fillRect(0,0,de,ze),F.save(),F.translate(de/2,ze/2),F.rotate(u*Math.PI/180),F.scale(l,f),F.imageSmoothingEnabled=k,F.imageSmoothingQuality=$,F.drawImage.apply(F,[a].concat(It(Qt.map(function(Jt){return Math.floor(ge(Jt))})))),F.restore(),G}var Kt=String.fromCharCode;function la(a,e,t){var i="";t+=e;for(var n=e;n<t;n+=1)i+=Kt(a.getUint8(n));return i}var ca=/^data:.*,/;function da(a){var e=a.replace(ca,""),t=atob(e),i=new ArrayBuffer(t.length),n=new Uint8Array(i);return H(n,function(r,s){n[s]=t.charCodeAt(s)}),i}function pa(a,e){for(var t=[],i=8192,n=new Uint8Array(a);n.length>0;)t.push(Kt.apply(null,$t(n.subarray(0,i)))),n=n.subarray(i);return"data:".concat(e,";base64,").concat(btoa(t.join("")))}function ua(a){var e=new DataView(a),t;try{var i,n,r;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var s=e.byteLength,h=2;h+1<s;){if(e.getUint8(h)===255&&e.getUint8(h+1)===225){n=h;break}h+=1}if(n){var u=n+4,o=n+10;if(la(e,u,4)==="Exif"){var l=e.getUint16(o);if(i=l===18761,(i||l===19789)&&e.getUint16(o+2,i)===42){var c=e.getUint32(o+4,i);c>=8&&(r=o+c)}}}if(r){var f=e.getUint16(r,i),x,y;for(y=0;y<f;y+=1)if(x=r+y*12+2,e.getUint16(x,i)===274){x+=8,t=e.getUint16(x,i),e.setUint16(x,1,i);break}}}catch{t=1}return t}function fa(a){var e=0,t=1,i=1;switch(a){case 2:t=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:i}}var ga={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,i=this.container,n=this.cropper,r=Number(t.minContainerWidth),s=Number(t.minContainerHeight);j(n,K),ee(e,K);var h={width:Math.max(i.offsetWidth,r>=0?r:Ft),height:Math.max(i.offsetHeight,s>=0?s:jt)};this.containerData=h,ne(n,{width:h.width,height:h.height}),j(e,K),ee(n,K)},initCanvas:function(){var e=this.containerData,t=this.imageData,i=this.options.viewMode,n=Math.abs(t.rotate)%180===90,r=n?t.naturalHeight:t.naturalWidth,s=n?t.naturalWidth:t.naturalHeight,h=r/s,u=e.width,o=e.height;e.height*h>e.width?i===3?u=e.height*h:o=e.width/h:i===3?o=e.width/h:u=e.height*h;var l={aspectRatio:h,naturalWidth:r,naturalHeight:s,width:u,height:o};this.canvasData=l,this.limited=i===1||i===2,this.limitCanvas(!0,!0),l.width=Math.min(Math.max(l.width,l.minWidth),l.maxWidth),l.height=Math.min(Math.max(l.height,l.minHeight),l.maxHeight),l.left=(e.width-l.width)/2,l.top=(e.height-l.height)/2,l.oldLeft=l.left,l.oldTop=l.top,this.initialCanvasData=P({},l)},limitCanvas:function(e,t){var i=this.options,n=this.containerData,r=this.canvasData,s=this.cropBoxData,h=i.viewMode,u=r.aspectRatio,o=this.cropped&&s;if(e){var l=Number(i.minCanvasWidth)||0,c=Number(i.minCanvasHeight)||0;h>1?(l=Math.max(l,n.width),c=Math.max(c,n.height),h===3&&(c*u>l?l=c*u:c=l/u)):h>0&&(l?l=Math.max(l,o?s.width:0):c?c=Math.max(c,o?s.height:0):o&&(l=s.width,c=s.height,c*u>l?l=c*u:c=l/u));var f=se({aspectRatio:u,width:l,height:c});l=f.width,c=f.height,r.minWidth=l,r.minHeight=c,r.maxWidth=1/0,r.maxHeight=1/0}if(t)if(h>(o?0:1)){var x=n.width-r.width,y=n.height-r.height;r.minLeft=Math.min(0,x),r.minTop=Math.min(0,y),r.maxLeft=Math.max(0,x),r.maxTop=Math.max(0,y),o&&this.limited&&(r.minLeft=Math.min(s.left,s.left+(s.width-r.width)),r.minTop=Math.min(s.top,s.top+(s.height-r.height)),r.maxLeft=s.left,r.maxTop=s.top,h===2&&(r.width>=n.width&&(r.minLeft=Math.min(0,x),r.maxLeft=Math.max(0,x)),r.height>=n.height&&(r.minTop=Math.min(0,y),r.maxTop=Math.max(0,y))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=n.width,r.maxTop=n.height},renderCanvas:function(e,t){var i=this.canvasData,n=this.imageData;if(t){var r=oa({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),s=r.width,h=r.height,u=i.width*(s/i.naturalWidth),o=i.height*(h/i.naturalHeight);i.left-=(u-i.width)/2,i.top-=(o-i.height)/2,i.width=u,i.height=o,i.aspectRatio=s/h,i.naturalWidth=s,i.naturalHeight=h,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,ne(this.canvas,P({width:i.width,height:i.height},Ce({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,i=this.imageData,n=i.naturalWidth*(t.width/t.naturalWidth),r=i.naturalHeight*(t.height/t.naturalHeight);P(i,{width:n,height:r,left:(t.width-n)/2,top:(t.height-r)/2}),ne(this.image,P({width:i.width,height:i.height},Ce(P({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,n=Number(e.autoCropArea)||.8,r={width:t.width,height:t.height};i&&(t.height*i>t.width?r.height=r.width/i:r.width=r.height*i),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*n),r.height=Math.max(r.minHeight,r.height*n),r.left=t.left+(t.width-r.width)/2,r.top=t.top+(t.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=P({},r)},limitCropBox:function(e,t){var i=this.options,n=this.containerData,r=this.canvasData,s=this.cropBoxData,h=this.limited,u=i.aspectRatio;if(e){var o=Number(i.minCropBoxWidth)||0,l=Number(i.minCropBoxHeight)||0,c=h?Math.min(n.width,r.width,r.width+r.left,n.width-r.left):n.width,f=h?Math.min(n.height,r.height,r.height+r.top,n.height-r.top):n.height;o=Math.min(o,n.width),l=Math.min(l,n.height),u&&(o&&l?l*u>o?l=o/u:o=l*u:o?l=o/u:l&&(o=l*u),f*u>c?f=c/u:c=f*u),s.minWidth=Math.min(o,c),s.minHeight=Math.min(l,f),s.maxWidth=c,s.maxHeight=f}t&&(h?(s.minLeft=Math.max(0,r.left),s.minTop=Math.max(0,r.top),s.maxLeft=Math.min(n.width,r.left+r.width)-s.width,s.maxTop=Math.min(n.height,r.top+r.height)-s.height):(s.minLeft=0,s.minTop=0,s.maxLeft=n.width-s.width,s.maxTop=n.height-s.height))},renderCropBox:function(){var e=this.options,t=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&Oe(this.face,De,i.width>=t.width&&i.height>=t.height?Wt:tt),ne(this.cropBox,P({width:i.width,height:i.height},Ce({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),me(this.element,Fe,this.getData())}},ma={initPreview:function(){var e=this.element,t=this.crossOrigin,i=this.options.preview,n=t?this.crossOriginUrl:this.url,r=e.alt||"The image to preview",s=document.createElement("img");if(t&&(s.crossOrigin=t),s.src=n,s.alt=r,this.viewBox.appendChild(s),this.viewBoxImage=s,!!i){var h=i;typeof i=="string"?h=e.ownerDocument.querySelectorAll(i):i.querySelector&&(h=[i]),this.previews=h,H(h,function(u){var o=document.createElement("img");Oe(u,Me,{width:u.offsetWidth,height:u.offsetHeight,html:u.innerHTML}),t&&(o.crossOrigin=t),o.src=n,o.alt=r,o.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',u.innerHTML="",u.appendChild(o)})}},resetPreview:function(){H(this.previews,function(e){var t=qe(e,Me);ne(e,{width:t.width,height:t.height}),e.innerHTML=t.html,aa(e,Me)})},preview:function(){var e=this.imageData,t=this.canvasData,i=this.cropBoxData,n=i.width,r=i.height,s=e.width,h=e.height,u=i.left-t.left-e.left,o=i.top-t.top-e.top;!this.cropped||this.disabled||(ne(this.viewBoxImage,P({width:s,height:h},Ce(P({translateX:-u,translateY:-o},e)))),H(this.previews,function(l){var c=qe(l,Me),f=c.width,x=c.height,y=f,S=x,b=1;n&&(b=f/n,S=r*b),r&&S>x&&(b=x/r,y=n*b,S=x),ne(l,{width:y,height:S}),ne(l.getElementsByTagName("img")[0],P({width:s*b,height:h*b},Ce(P({translateX:-u*b,translateY:-o*b},e))))}))}},va={bind:function(){var e=this.element,t=this.options,i=this.cropper;q(t.cropstart)&&Z(e,Ve,t.cropstart),q(t.cropmove)&&Z(e,$e,t.cropmove),q(t.cropend)&&Z(e,je,t.cropend),q(t.crop)&&Z(e,Fe,t.crop),q(t.zoom)&&Z(e,Ge,t.zoom),Z(i,mt,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&Z(i,bt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Z(i,gt,this.onDblclick=this.dblclick.bind(this)),Z(e.ownerDocument,vt,this.onCropMove=this.cropMove.bind(this)),Z(e.ownerDocument,yt,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&Z(window,xt,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,i=this.cropper;q(t.cropstart)&&Q(e,Ve,t.cropstart),q(t.cropmove)&&Q(e,$e,t.cropmove),q(t.cropend)&&Q(e,je,t.cropend),q(t.crop)&&Q(e,Fe,t.crop),q(t.zoom)&&Q(e,Ge,t.zoom),Q(i,mt,this.onCropStart),t.zoomable&&t.zoomOnWheel&&Q(i,bt,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Q(i,gt,this.onDblclick),Q(e.ownerDocument,vt,this.onCropMove),Q(e.ownerDocument,yt,this.onCropEnd),t.responsive&&Q(window,xt,this.onResize)}},ya={resize:function(){if(!this.disabled){var e=this.options,t=this.container,i=this.containerData,n=t.offsetWidth/i.width,r=t.offsetHeight/i.height,s=Math.abs(n-1)>Math.abs(r-1)?n:r;if(s!==1){var h,u;e.restore&&(h=this.getCanvasData(),u=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(H(h,function(o,l){h[l]=o*s})),this.setCropBoxData(H(u,function(o,l){u[l]=o*s})))}}},dblclick:function(){this.disabled||this.options.dragMode===Xt||this.setDragMode(ta(this.dragBox,Ye)?Yt:it)},wheel:function(e){var t=this,i=Number(this.options.wheelZoomRatio)||.1,n=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?n=e.deltaY>0?1:-1:e.wheelDelta?n=-e.wheelDelta/120:e.detail&&(n=e.detail>0?1:-1),this.zoom(-n*i,e)))},cropStart:function(e){var t=e.buttons,i=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(M(t)&&t!==1||M(i)&&i!==0||e.ctrlKey))){var n=this.options,r=this.pointers,s;e.changedTouches?H(e.changedTouches,function(h){r[h.identifier]=Se(h)}):r[e.pointerId||0]=Se(e),Object.keys(r).length>1&&n.zoomable&&n.zoomOnTouch?s=Ht:s=qe(e.target,De),ji.test(s)&&me(this.element,Ve,{originalEvent:e,action:s})!==!1&&(e.preventDefault(),this.action=s,this.cropping=!1,s===_t&&(this.cropping=!0,j(this.dragBox,Re)))}},cropMove:function(e){var t=this.action;if(!(this.disabled||!t)){var i=this.pointers;e.preventDefault(),me(this.element,$e,{originalEvent:e,action:t})!==!1&&(e.changedTouches?H(e.changedTouches,function(n){P(i[n.identifier]||{},Se(n,!0))}):P(i[e.pointerId||0]||{},Se(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,i=this.pointers;e.changedTouches?H(e.changedTouches,function(n){delete i[n.identifier]}):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,fe(this.dragBox,Re,this.cropped&&this.options.modal)),me(this.element,je,{originalEvent:e,action:t}))}}},wa={change:function(e){var t=this.options,i=this.canvasData,n=this.containerData,r=this.cropBoxData,s=this.pointers,h=this.action,u=t.aspectRatio,o=r.left,l=r.top,c=r.width,f=r.height,x=o+c,y=l+f,S=0,b=0,C=n.width,U=n.height,k=!0,L;!u&&e.shiftKey&&(u=c&&f?c/f:1),this.limited&&(S=r.minLeft,b=r.minTop,C=S+Math.min(n.width,i.width,i.left+i.width),U=b+Math.min(n.height,i.height,i.top+i.height));var $=s[Object.keys(s)[0]],g={x:$.endX-$.startX,y:$.endY-$.startY},w=function(A){switch(A){case he:x+g.x>C&&(g.x=C-x);break;case le:o+g.x<S&&(g.x=S-o);break;case ie:l+g.y<b&&(g.y=b-l);break;case pe:y+g.y>U&&(g.y=U-y);break}};switch(h){case tt:o+=g.x,l+=g.y;break;case he:if(g.x>=0&&(x>=C||u&&(l<=b||y>=U))){k=!1;break}w(he),c+=g.x,c<0&&(h=le,c=-c,o-=c),u&&(f=c/u,l+=(r.height-f)/2);break;case ie:if(g.y<=0&&(l<=b||u&&(o<=S||x>=C))){k=!1;break}w(ie),f-=g.y,l+=g.y,f<0&&(h=pe,f=-f,l-=f),u&&(c=f*u,o+=(r.width-c)/2);break;case le:if(g.x<=0&&(o<=S||u&&(l<=b||y>=U))){k=!1;break}w(le),c-=g.x,o+=g.x,c<0&&(h=he,c=-c,o-=c),u&&(f=c/u,l+=(r.height-f)/2);break;case pe:if(g.y>=0&&(y>=U||u&&(o<=S||x>=C))){k=!1;break}w(pe),f+=g.y,f<0&&(h=ie,f=-f,l-=f),u&&(c=f*u,o+=(r.width-c)/2);break;case ye:if(u){if(g.y<=0&&(l<=b||x>=C)){k=!1;break}w(ie),f-=g.y,l+=g.y,c=f*u}else w(ie),w(he),g.x>=0?x<C?c+=g.x:g.y<=0&&l<=b&&(k=!1):c+=g.x,g.y<=0?l>b&&(f-=g.y,l+=g.y):(f-=g.y,l+=g.y);c<0&&f<0?(h=be,f=-f,c=-c,l-=f,o-=c):c<0?(h=we,c=-c,o-=c):f<0&&(h=xe,f=-f,l-=f);break;case we:if(u){if(g.y<=0&&(l<=b||o<=S)){k=!1;break}w(ie),f-=g.y,l+=g.y,c=f*u,o+=r.width-c}else w(ie),w(le),g.x<=0?o>S?(c-=g.x,o+=g.x):g.y<=0&&l<=b&&(k=!1):(c-=g.x,o+=g.x),g.y<=0?l>b&&(f-=g.y,l+=g.y):(f-=g.y,l+=g.y);c<0&&f<0?(h=xe,f=-f,c=-c,l-=f,o-=c):c<0?(h=ye,c=-c,o-=c):f<0&&(h=be,f=-f,l-=f);break;case be:if(u){if(g.x<=0&&(o<=S||y>=U)){k=!1;break}w(le),c-=g.x,o+=g.x,f=c/u}else w(pe),w(le),g.x<=0?o>S?(c-=g.x,o+=g.x):g.y>=0&&y>=U&&(k=!1):(c-=g.x,o+=g.x),g.y>=0?y<U&&(f+=g.y):f+=g.y;c<0&&f<0?(h=ye,f=-f,c=-c,l-=f,o-=c):c<0?(h=xe,c=-c,o-=c):f<0&&(h=we,f=-f,l-=f);break;case xe:if(u){if(g.x>=0&&(x>=C||y>=U)){k=!1;break}w(he),c+=g.x,f=c/u}else w(pe),w(he),g.x>=0?x<C?c+=g.x:g.y>=0&&y>=U&&(k=!1):c+=g.x,g.y>=0?y<U&&(f+=g.y):f+=g.y;c<0&&f<0?(h=we,f=-f,c=-c,l-=f,o-=c):c<0?(h=be,c=-c,o-=c):f<0&&(h=ye,f=-f,l-=f);break;case Wt:this.move(g.x,g.y),k=!1;break;case Ht:this.zoom(na(s),e),k=!1;break;case _t:if(!g.x||!g.y){k=!1;break}L=qt(this.cropper),o=$.startX-L.left,l=$.startY-L.top,c=r.minWidth,f=r.minHeight,g.x>0?h=g.y>0?xe:ye:g.x<0&&(o-=c,h=g.y>0?be:we),g.y<0&&(l-=f),this.cropped||(ee(this.cropBox,K),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}k&&(r.width=c,r.height=f,r.left=o,r.top=l,this.action=h,this.renderCropBox()),H(s,function(D){D.startX=D.endX,D.startY=D.endY})}},xa={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&j(this.dragBox,Re),ee(this.cropBox,K),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=P({},this.initialImageData),this.canvasData=P({},this.initialCanvasData),this.cropBoxData=P({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(P(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ee(this.dragBox,Re),j(this.cropBox,K)),this},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,H(this.previews,function(i){i.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ee(this.cropper,ut)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,j(this.cropper,ut)),this},destroy:function(){var e=this.element;return e[z]?(e[z]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,n=i.left,r=i.top;return this.moveTo(Be(e)?e:n+Number(e),Be(t)?t:r+Number(t))},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(M(e)&&(i.left=e,n=!0),M(t)&&(i.top=t,n=!0),n&&this.renderCanvas(!0)),this},zoom:function(e,t){var i=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo:function(e,t,i){var n=this.options,r=this.canvasData,s=r.width,h=r.height,u=r.naturalWidth,o=r.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&n.zoomable){var l=u*e,c=o*e;if(me(this.element,Ge,{ratio:e,oldRatio:s/u,originalEvent:i})===!1)return this;if(i){var f=this.pointers,x=qt(this.cropper),y=f&&Object.keys(f).length?sa(f):{pageX:i.pageX,pageY:i.pageY};r.left-=(l-s)*((y.pageX-x.left-r.left)/s),r.top-=(c-h)*((y.pageY-x.top-r.top)/h)}else ue(t)&&M(t.x)&&M(t.y)?(r.left-=(l-s)*((t.x-r.left)/s),r.top-=(c-h)*((t.y-r.top)/h)):(r.left-=(l-s)/2,r.top-=(c-h)/2);r.width=l,r.height=c,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),M(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,M(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(M(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.imageData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(M(e)&&(i.scaleX=e,n=!0),M(t)&&(i.scaleY=t,n=!0),n&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.options,i=this.imageData,n=this.canvasData,r=this.cropBoxData,s;if(this.ready&&this.cropped){s={x:r.left-n.left,y:r.top-n.top,width:r.width,height:r.height};var h=i.width/i.naturalWidth;if(H(s,function(l,c){s[c]=l/h}),e){var u=Math.round(s.y+s.height),o=Math.round(s.x+s.width);s.x=Math.round(s.x),s.y=Math.round(s.y),s.width=o-s.x,s.height=u-s.y}}else s={x:0,y:0,width:0,height:0};return t.rotatable&&(s.rotate=i.rotate||0),t.scalable&&(s.scaleX=i.scaleX||1,s.scaleY=i.scaleY||1),s},setData:function(e){var t=this.options,i=this.imageData,n=this.canvasData,r={};if(this.ready&&!this.disabled&&ue(e)){var s=!1;t.rotatable&&M(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,s=!0),t.scalable&&(M(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,s=!0),M(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,s=!0)),s&&this.renderCanvas(!0,!0);var h=i.width/i.naturalWidth;M(e.x)&&(r.left=e.x*h+n.left),M(e.y)&&(r.top=e.y*h+n.top),M(e.width)&&(r.width=e.width*h),M(e.height)&&(r.height=e.height*h),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?P({},this.containerData):{}},getImageData:function(){return this.sized?P({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&H(["left","top","width","height","naturalWidth","naturalHeight"],function(i){t[i]=e[i]}),t},setCanvasData:function(e){var t=this.canvasData,i=t.aspectRatio;return this.ready&&!this.disabled&&ue(e)&&(M(e.left)&&(t.left=e.left),M(e.top)&&(t.top=e.top),M(e.width)?(t.width=e.width,t.height=e.width/i):M(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this.cropBoxData,i=this.options.aspectRatio,n,r;return this.ready&&this.cropped&&!this.disabled&&ue(e)&&(M(e.left)&&(t.left=e.left),M(e.top)&&(t.top=e.top),M(e.width)&&e.width!==t.width&&(n=!0,t.width=e.width),M(e.height)&&e.height!==t.height&&(r=!0,t.height=e.height),i&&(n?t.height=t.width/i:r&&(t.width=t.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,i=ha(this.image,this.imageData,t,e);if(!this.cropped)return i;var n=this.getData(),r=n.x,s=n.y,h=n.width,u=n.height,o=i.width/Math.floor(t.naturalWidth);o!==1&&(r*=o,s*=o,h*=o,u*=o);var l=h/u,c=se({aspectRatio:l,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=se({aspectRatio:l,width:e.minWidth||0,height:e.minHeight||0},"cover"),x=se({aspectRatio:l,width:e.width||(o!==1?i.width:h),height:e.height||(o!==1?i.height:u)}),y=x.width,S=x.height;y=Math.min(c.width,Math.max(f.width,y)),S=Math.min(c.height,Math.max(f.height,S));var b=document.createElement("canvas"),C=b.getContext("2d");b.width=ge(y),b.height=ge(S),C.fillStyle=e.fillColor||"transparent",C.fillRect(0,0,y,S);var U=e.imageSmoothingEnabled,k=U===void 0?!0:U,L=e.imageSmoothingQuality;C.imageSmoothingEnabled=k,L&&(C.imageSmoothingQuality=L);var $=i.width,g=i.height,w=r,D=s,A,T,B,R,_,G;w<=-h||w>$?(w=0,A=0,B=0,_=0):w<=0?(B=-w,w=0,A=Math.min($,h+w),_=A):w<=$&&(B=0,A=Math.min(h,$-w),_=A),A<=0||D<=-u||D>g?(D=0,T=0,R=0,G=0):D<=0?(R=-D,D=0,T=Math.min(g,u+D),G=T):D<=g&&(R=0,T=Math.min(u,g-D),G=T);var F=[w,D,A,T];if(_>0&&G>0){var J=y/h;F.push(B*J,R*J,_*J,G*J)}return C.drawImage.apply(C,[i].concat(It(F.map(function(oe){return Math.floor(ge(oe))})))),b},setAspectRatio:function(e){var t=this.options;return!this.disabled&&!Be(e)&&(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,i=this.dragBox,n=this.face;if(this.ready&&!this.disabled){var r=e===it,s=t.movable&&e===Yt;e=r||s?e:Xt,t.dragMode=e,Oe(i,De,e),fe(i,Ye,r),fe(i,Xe,s),t.cropBoxMovable||(Oe(n,De,e),fe(n,Ye,r),fe(n,Xe,s))}return this}},ba=te.Cropper,Zt=function(){function a(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Pi(this,a),!e||!Gi.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=P({},Ct,ue(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return Ui(a,[{key:"init",value:function(){var t=this.element,i=t.tagName.toLowerCase(),n;if(!t[z]){if(t[z]=this,i==="img"){if(this.isImg=!0,n=t.getAttribute("src")||"",this.originalUrl=n,!n)return;n=t.src}else i==="canvas"&&window.HTMLCanvasElement&&(n=t.toDataURL());this.load(n)}}},{key:"load",value:function(t){var i=this;if(t){this.url=t,this.imageData={};var n=this.element,r=this.options;if(!r.rotatable&&!r.scalable&&(r.checkOrientation=!1),!r.checkOrientation||!window.ArrayBuffer){this.clone();return}if($i.test(t)){Vi.test(t)?this.read(da(t)):this.clone();return}var s=new XMLHttpRequest,h=this.clone.bind(this);this.reloading=!0,this.xhr=s,s.onabort=h,s.onerror=h,s.ontimeout=h,s.onprogress=function(){s.getResponseHeader("content-type")!==Tt&&s.abort()},s.onload=function(){i.read(s.response)},s.onloadend=function(){i.reloading=!1,i.xhr=null},r.checkCrossOrigin&&Ot(t)&&n.crossOrigin&&(t=Et(t)),s.open("GET",t,!0),s.responseType="arraybuffer",s.withCredentials=n.crossOrigin==="use-credentials",s.send()}}},{key:"read",value:function(t){var i=this.options,n=this.imageData,r=ua(t),s=0,h=1,u=1;if(r>1){this.url=pa(t,Tt);var o=fa(r);s=o.rotate,h=o.scaleX,u=o.scaleY}i.rotatable&&(n.rotate=s),i.scalable&&(n.scaleX=h,n.scaleY=u),this.clone()}},{key:"clone",value:function(){var t=this.element,i=this.url,n=t.crossOrigin,r=i;this.options.checkCrossOrigin&&Ot(i)&&(n||(n="anonymous"),r=Et(i)),this.crossOrigin=n,this.crossOriginUrl=r;var s=document.createElement("img");n&&(s.crossOrigin=n),s.src=r||i,s.alt=t.alt||"The image to crop",this.image=s,s.onload=this.start.bind(this),s.onerror=this.stop.bind(this),j(s,ft),t.parentNode.insertBefore(s,t.nextSibling)}},{key:"start",value:function(){var t=this,i=this.image;i.onload=null,i.onerror=null,this.sizing=!0;var n=te.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(te.navigator.userAgent),r=function(o,l){P(t.imageData,{naturalWidth:o,naturalHeight:l,aspectRatio:o/l}),t.initialImageData=P({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(i.naturalWidth&&!n){r(i.naturalWidth,i.naturalHeight);return}var s=document.createElement("img"),h=document.body||document.documentElement;this.sizingImage=s,s.onload=function(){r(s.width,s.height),n||h.removeChild(s)},s.src=i.src,n||(s.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",h.appendChild(s))}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var t=this.element,i=this.options,n=this.image,r=t.parentNode,s=document.createElement("div");s.innerHTML=qi;var h=s.querySelector(".".concat(z,"-container")),u=h.querySelector(".".concat(z,"-canvas")),o=h.querySelector(".".concat(z,"-drag-box")),l=h.querySelector(".".concat(z,"-crop-box")),c=l.querySelector(".".concat(z,"-face"));this.container=r,this.cropper=h,this.canvas=u,this.dragBox=o,this.cropBox=l,this.viewBox=h.querySelector(".".concat(z,"-view-box")),this.face=c,u.appendChild(n),j(t,K),r.insertBefore(h,t.nextSibling),ee(n,ft),this.initPreview(),this.bind(),i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN,i.aspectRatio=Math.max(0,i.aspectRatio)||NaN,i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0,j(l,K),i.guides||j(l.getElementsByClassName("".concat(z,"-dashed")),K),i.center||j(l.getElementsByClassName("".concat(z,"-center")),K),i.background&&j(h,"".concat(z,"-bg")),i.highlight||j(c,Hi),i.cropBoxMovable&&(j(c,Xe),Oe(c,De,tt)),i.cropBoxResizable||(j(l.getElementsByClassName("".concat(z,"-line")),K),j(l.getElementsByClassName("".concat(z,"-point")),K)),this.render(),this.ready=!0,this.setDragMode(i.dragMode),i.autoCrop&&this.crop(),this.setData(i.data),q(i.ready)&&Z(t,wt,i.ready,{once:!0}),me(t,wt)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var t=this.cropper.parentNode;t&&t.removeChild(this.cropper),ee(this.element,K)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ba,a}},{key:"setDefaults",value:function(t){P(Ct,ue(t)&&t)}}]),a}();P(Zt.prototype,ga,ma,va,ya,wa,xa);var ae=function(){return ae=Object.assign||function(a){for(var e,t=1,i=arguments.length;t<i;t++)for(var n in e=arguments[t])Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a},ae.apply(this,arguments)};function Ie(a,e){var t={};for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&e.indexOf(i)<0&&(t[i]=a[i]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(i=Object.getOwnPropertySymbols(a);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(a,i[n])&&(t[i[n]]=a[i[n]])}return t}var Mt,Ne={},Te={},St;St={get exports(){return Ne},set exports(a){Ne=a}},St.exports=function(){if(Mt)return Te;Mt=1;var a=I,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function s(h,u,o){var l,c={},f=null,x=null;for(l in o!==void 0&&(f=""+o),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(x=u.ref),u)i.call(u,l)&&!r.hasOwnProperty(l)&&(c[l]=u[l]);if(h&&h.defaultProps)for(l in u=h.defaultProps)c[l]===void 0&&(c[l]=u[l]);return{$$typeof:e,type:h,key:f,ref:x,props:c,_owner:n.current}}return Te.Fragment=t,Te.jsx=s,Te.jsxs=s,Te}();var Ta=["aspectRatio","autoCrop","autoCropArea","background","center","checkCrossOrigin","checkOrientation","cropBoxMovable","cropBoxResizable","data","dragMode","guides","highlight","initialAspectRatio","minCanvasHeight","minCanvasWidth","minContainerHeight","minContainerWidth","minCropBoxHeight","minCropBoxWidth","modal","movable","preview","responsive","restore","rotatable","scalable","toggleDragModeOnDblclick","viewMode","wheelZoomRatio","zoomOnTouch","zoomOnWheel","zoomable","cropstart","cropmove","cropend","crop","zoom","ready"],Ca={opacity:0,maxWidth:"100%"},Da=I.forwardRef(function(a,e){var t=Ie(a,[]),i=t.dragMode,n=i===void 0?"crop":i,r=t.src,s=t.style,h=t.className,u=t.crossOrigin,o=t.scaleX,l=t.scaleY,c=t.enable,f=t.zoomTo,x=t.rotateTo,y=t.alt,S=y===void 0?"picture":y,b=t.ready,C=t.onInitialized,U=Ie(t,["dragMode","src","style","className","crossOrigin","scaleX","scaleY","enable","zoomTo","rotateTo","alt","ready","onInitialized"]),k={scaleY:l,scaleX:o,enable:c,zoomTo:f,rotateTo:x},L=function(){for(var g=[],w=0;w<arguments.length;w++)g[w]=arguments[w];var D=V.useRef(null);return I.useEffect(function(){g.forEach(function(A){A&&(typeof A=="function"?A(D.current):A.current=D.current)})},[g]),D}(e,V.useRef(null));V.useEffect(function(){var g;!((g=L.current)===null||g===void 0)&&g.cropper&&typeof f=="number"&&L.current.cropper.zoomTo(f)},[t.zoomTo]),V.useEffect(function(){var g;!((g=L.current)===null||g===void 0)&&g.cropper&&r!==void 0&&L.current.cropper.reset().clear().replace(r)},[r]),V.useEffect(function(){if(L.current!==null){var g=new Zt(L.current,ae(ae({dragMode:n},U),{ready:function(w){w.currentTarget!==null&&function(D,A){A===void 0&&(A={});var T=A.enable,B=T===void 0||T,R=A.scaleX,_=R===void 0?1:R,G=A.scaleY,F=G===void 0?1:G,J=A.zoomTo,oe=J===void 0?0:J,de=A.rotateTo;B?D.enable():D.disable(),D.scaleX(_),D.scaleY(F),de!==void 0&&D.rotateTo(de),oe>0&&D.zoomTo(oe)}(w.currentTarget.cropper,k),b&&b(w)}}));C&&C(g)}return function(){var w,D;(D=(w=L.current)===null||w===void 0?void 0:w.cropper)===null||D===void 0||D.destroy()}},[L]);var $=function(g){return Ta.reduce(function(w,D){var A=w,T=D;return A[T],Ie(A,[typeof T=="symbol"?T:T+""])},g)}(ae(ae({},U),{crossOrigin:u,src:r,alt:S}));return Ne.jsx("div",ae({style:s,className:h},{children:Ne.jsx("img",ae({},$,{style:Ca,ref:L}))}))});const Oa=a=>{const[e,t]=V.useState(!0),[i,n]=V.useState([]),[r,s]=V.useState(""),[h,u]=V.useState(),[o,l]=V.useState(!1),[c,f]=V.useState(!1),{title:x}=a,{user:y}=a,{buttonText:S}=a,{organization:b}=a;let C;const U=T=>{T.preventDefault();let B;T.dataTransfer?B=T.dataTransfer.files:T.target&&(B=T.target.files);const R=new FileReader;R.onload=()=>{s(R.result)},B[0]instanceof Blob&&R.readAsDataURL(B[0])},k=()=>{h.getCroppedCanvas().toBlob(T=>{if(T===null)return X("error","You must select a picture first!"),!1;const B=r.substring(r.indexOf("/")+1,r.indexOf(";base64")),R=`avatar/${y.owner}/${y.name}.${B}`;return Ei(y.owner,y.name,"avatar","CropperDiv",R,T).then(_=>{_.status==="ok"?window.location.href=window.location.pathname:X("error",_.msg)}),!0})},L=()=>{l(!0)},$=()=>{f(!0),k()||f(!1)},g=()=>{l(!1)},w=()=>{C.click()},D=T=>{const B=[];B.push({value:b==null?void 0:b.defaultAvatar});for(let R=0;R<T.length;R++)if(T[R].fileType==="image"){const _=`${T[R].url}`;B.push({value:_})}return B},A=T=>new Promise(B=>{const R=new Image;R.src=T,R.setAttribute("crossOrigin","anonymous"),R.onload=()=>{const _=document.createElement("canvas");_.width=R.width,_.height=R.height,_.getContext("2d").drawImage(R,0,0,R.width,R.height);const F=_.toDataURL("image/png");B(F)}});return V.useEffect(()=>{t(!0),Oi(y.owner,y.name,"","","","","","").then(T=>{t(!1),n(D(T))})},[]),m("div",{children:[d(W,{type:"default",onClick:L,children:S}),d(Ke,{maskClosable:!1,title:x,open:o,okText:p.t("user:Upload a photo"),confirmLoading:c,onCancel:g,width:600,footer:[d(W,{block:!0,type:"primary",onClick:$,children:p.t("user:Set new profile picture")},"submit")],children:m(v,{style:{margin:"0px auto 60px auto",width:1e3,height:350},children:[m(E,{style:{width:"100%",marginBottom:"20px"},children:[d("input",{style:{display:"none"},ref:T=>C=T,type:"file",accept:"image/*",onChange:U}),d(W,{block:!0,onClick:w,children:p.t("user:Select a photo...")}),d(re,{virtual:!1,style:{width:"100%"},loading:e,placeholder:p.t("user:Please select avatar from resources"),onChange:async T=>{s(await A(T))},options:i,allowClear:!0})]}),d(Da,{style:{height:"100%"},initialAspectRatio:1,preview:".img-preview",src:r,viewMode:1,guides:!0,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1,onInitialized:T=>{u(T)}})]})})]})},Ea=a=>{const[e,t]=I.useState(!1),[i,n]=I.useState(!1),[r,s]=I.useState(""),[h,u]=I.useState(""),[o,l]=I.useState(""),{user:c}=a,{account:f}=a,x=()=>{t(!0)},y=()=>{t(!1)},S=()=>{if(h===""||o===""){X("error",p.t("user:Empty input!"));return}if(h!==o){X("error",p.t("user:Two passwords you typed do not match."));return}n(!0),ii(c.owner,c.name,r,h).then(C=>{n(!1),C.status==="ok"?(X("success",p.t("user:Password set successfully")),t(!1)):X("error",p.t(`user:${C.msg}`))})},b=c.password!=="";return m(E,{children:[d(W,{type:"default",disabled:a.disabled,onClick:x,children:b?p.t("user:Modify password..."):p.t("user:Set password...")}),d(Ke,{maskClosable:!1,title:p.t("general:Password"),open:e,okText:p.t("user:Set Password"),cancelText:p.t("general:Cancel"),confirmLoading:i,onCancel:y,onOk:S,width:600,children:m(v,{style:{margin:"0px auto 40px auto",width:1e3,height:300},children:[b&&!_e(f)?d(E,{style:{width:"100%",marginBottom:"20px"},children:d(Y.Password,{addonBefore:p.t("user:Old Password"),placeholder:p.t("user:input password"),onChange:C=>s(C.target.value)})}):null,d(E,{style:{width:"100%",marginBottom:"20px"},children:d(Y.Password,{addonBefore:p.t("user:New Password"),placeholder:p.t("user:input password"),onChange:C=>u(C.target.value)})}),d(E,{style:{width:"100%",marginBottom:"20px"},children:d(Y.Password,{addonBefore:p.t("user:Re-enter New"),placeholder:p.t("user:input password"),onChange:C=>l(C.target.value)})})]})})]})},At=a=>{const[e,t]=I.useState(!1),[i,n]=I.useState(!1),[r,s]=I.useState(""),[h,u]=I.useState(""),{buttonText:o,destType:l,application:c,countryCode:f}=a,x=()=>{t(!0)},y=()=>{t(!1)},S=()=>{if(r===""){l==="phone"?X("error",p.t("user:Phone cannot be empty")):X("error",p.t("user:Email cannot be empty"));return}if(h===""){X("error",p.t("code:Empty code"));return}n(!0),si(r,l,h).then(C=>{C.status==="ok"?(X("success",p.t("user:Email/phone reset successfully")),window.location.reload()):(X("error",p.t("user:"+C.msg)),n(!1))})};let b="";return l==="email"?b=p.t("user:Input your email"):l==="phone"&&(b=p.t("user:Input your phone number")),m(E,{children:[d(W,{type:"default",onClick:x,children:o}),d(Ke,{maskClosable:!1,title:o,open:e,okText:o,cancelText:p.t("general:Cancel"),confirmLoading:i,onCancel:y,onOk:S,width:600,children:m(v,{style:{margin:"0px auto 40px auto",width:1e3,height:300},children:[d(E,{style:{width:"100%",marginBottom:"20px"},children:d(Y,{addonBefore:l==="email"?p.t("user:New Email"):p.t("user:New phone"),prefix:l==="email"?m(I.Fragment,{children:[d(ki,{}),"  "]}):m(I.Fragment,{children:[d(zi,{}),"  ",f!==""?"+":null,ai(f)," "]}),placeholder:b,onChange:C=>s(C.target.value)})}),d(E,{style:{width:"100%",marginBottom:"20px"},children:d(ri,{textBefore:p.t("code:Code you received"),onChange:u,method:"reset",onButtonClickArgs:[r,l,ni(c)],application:c})})]})})]})};class Ma extends I.Component{constructor(e){super(e),this.state={classes:e,addressOptions:[],affiliationOptions:[]}}renderIdp(e,t,i){const n=i.provider,r=e.name;return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:this.props.labelSpan,children:[oi(n),d("span",{style:{marginLeft:"5px"},children:`${n.type}:`})]}),d(v,{span:24-this.props.labelSpan,style:{marginTop:"5px"},children:d("span",{style:{width:this.props.labelSpan===3?"300px":"130px",display:O()?"inline":"inline-block"},children:r})})]},n.name)}render(){return this.renderIdp(this.props.user,this.props.application,this.props.providerItem)}}class Sa extends I.Component{deleteRow(e,t){e=Ze(e,t),this.props.updateTable(e)}registerWebAuthn(){hi().then(e=>{e.status==="ok"?X("success","Successfully added webauthn credentials"):X("error",e.msg),this.props.refresh()}).catch(e=>{X("error",`${p.t("general:Failed to connect to server")}: ${e}`)})}render(){const e=[{title:p.t("general:Name"),dataIndex:"ID",key:"ID"},{title:p.t("general:Action"),key:"action",width:"170px",render:(t,i,n)=>d(W,{style:{marginTop:"5px",marginBottom:"5px",marginRight:"5px"},type:"primary",danger:!0,onClick:()=>{this.deleteRow(this.props.table,n)},children:p.t("general:Delete")})}];return d(Qe,{rowKey:"ID",columns:e,dataSource:this.props.table,size:"middle",bordered:!0,pagination:!1,title:()=>m("div",{children:[p.t("user:WebAuthn credentials"),"    ",d(W,{disabled:!this.props.isSelf,style:{marginRight:"5px"},type:"primary",size:"small",onClick:()=>{this.registerWebAuthn()},children:p.t("general:Add")})]})})}}const{Option:Aa}=re;var Rt;class Ra extends I.Component{constructor(t){super(t);ve(this,"count",((Rt=this.props.table)==null?void 0:Rt.length)??0);this.state={classes:t,managedAccounts:this.props.table!==null?this.props.table.map((i,n)=>(i.key=n,i)):[]}}updateTable(t){this.setState({managedAccounts:t}),this.props.onUpdateTable([...t].map(i=>{const n=kt(i);return delete n.key,n}))}updateField(t,i,n,r){t[i][n]=r,this.updateTable(t)}addRow(t){const i={key:this.count,application:"",username:"",password:""};t==null&&(t=[]),this.count+=1,t=zt(t,i),this.updateTable(t)}deleteRow(t,i){t=Ze(t,i),this.updateTable(t)}upRow(t,i){t=ht(t,i-1,i),this.updateTable(t)}downRow(t,i){t=ht(t,i,i+1),this.updateTable(t)}renderTable(t){const i=[{title:p.t("general:Application"),dataIndex:"application",key:"application",render:(n,r,s)=>{const h=this.props.applications;return d(re,{virtual:!1,style:{width:"100%"},value:n,onChange:u=>{this.updateField(t,s,"application",u)},children:h.map((u,o)=>d(Aa,{value:u.name,children:u.name},o))})}},{title:p.t("signup:Username"),dataIndex:"username",key:"username",width:"420px",render:(n,r,s)=>d(Y,{defaultValue:n,onChange:h=>{this.updateField(t,s,"username",h.target.value)}})},{title:p.t("general:Password"),dataIndex:"password",key:"password",width:"420px",render:(n,r,s)=>d(Y,{defaultValue:n,onChange:h=>{this.updateField(t,s,"password",h.target.value)}})},{title:p.t("general:Action"),key:"action",width:"100px",render:(n,r,s)=>m("div",{children:[d(Pe,{placement:"bottomLeft",title:p.t("general:Up"),children:d(W,{style:{marginRight:"5px"},disabled:s===0,icon:d(Mi,{}),size:"small",onClick:()=>this.upRow(t,s)})}),d(Pe,{placement:"topLeft",title:p.t("general:Down"),children:d(W,{style:{marginRight:"5px"},disabled:s===t.length-1,icon:d(li,{}),size:"small",onClick:()=>this.downRow(t,s)})}),d(Pe,{placement:"topLeft",title:p.t("general:Delete"),children:d(W,{icon:d(Pt,{}),size:"small",onClick:()=>this.deleteRow(t,s)})})]})}];return d(Qe,{scroll:{x:"max-content"},rowKey:"key",columns:i,dataSource:t,size:"middle",bordered:!0,pagination:!1,title:()=>m("div",{children:[this.props.title,"    ",d(W,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:()=>this.addRow(t),children:p.t("general:Add")})]})})}render(){return d("div",{children:d(E,{style:{marginTop:"20px"},children:d(v,{span:24,children:this.renderTable(this.state.managedAccounts)})})})}}class Na extends I.Component{constructor(t){super(t);ve(this,"page",1);ve(this,"pageSize",10);ve(this,"count",this.props.properties!==null?Object.entries(this.props.properties).length:0);this.state={properties:[]},this.props.properties!==null&&Object.entries(this.props.properties).map((i,n)=>{this.state.properties.push({key:n,name:i[0],value:i[1]})})}updateTable(t){this.setState({properties:t});const i={};t.map(n=>{i[n.name]=n.value}),this.props.onUpdateTable(i)}addRow(t){const i={key:this.count,name:"",value:""};t===void 0&&(t=[]),t=zt(t,i),this.count=this.count+1,this.updateTable(t)}deleteRow(t,i){t=Ze(t,this.getIndex(i)),this.updateTable(t)}getIndex(t){return t+(this.page-1)*this.pageSize}updateField(t,i,n,r){t[this.getIndex(i)][n]=r,this.updateTable(t)}renderTable(t){const i=[{title:p.t("user:Keys"),dataIndex:"name",width:"200px",render:(n,r,s)=>d(Y,{value:n,onChange:h=>{this.updateField(t,s,"name",h.target.value)}})},{title:p.t("user:Values"),dataIndex:"value",width:"200px",render:(n,r,s)=>d(Y,{value:n,onChange:h=>{this.updateField(t,s,"value",h.target.value)}})},{title:p.t("general:Action"),dataIndex:"operation",width:"20px",render:(n,r,s)=>d(W,{icon:d(Pt,{}),size:"small",onClick:()=>this.deleteRow(t,s)})}];return d(Qe,{title:()=>d("div",{children:d(W,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:()=>this.addRow(t),children:p.t("general:Add")})}),pagination:{defaultPageSize:this.pageSize,onChange:n=>{this.page=n}},columns:i,dataSource:t,rowKey:"key",size:"middle",bordered:!0})}render(){return d(I.Fragment,{children:this.renderTable(this.state.properties)})}}const{Option:ka}=re;class Ya extends I.Component{constructor(e){super(e),this.state={classes:e,organizationName:e.organizationName!==void 0?e.organizationName:e.match.params.organizationName,userName:e.userName!==void 0?e.userName:e.match.params.userName,user:null,application:null,organizations:[],applications:[],mode:e.location.mode!==void 0?e.location.mode:"edit",loading:!0,returnUrl:null}}UNSAFE_componentWillMount(){this.getUser(),this.getOrganizations(),this.getApplicationsByOrganization(this.state.organizationName),this.getUserApplication(),this.setReturnUrl()}getUser(){ci(this.state.organizationName,this.state.userName).then(e=>{(e.status===null||e.status!=="error")&&this.setState({user:e}),this.setState({loading:!1})})}getOrganizations(){di("admin").then(e=>{this.setState({organizations:e.msg===void 0?e:[]})})}getApplicationsByOrganization(e){pi("admin",e).then(t=>{this.setState({applications:t.msg===void 0?t:[]})})}getUserApplication(){ui(this.state.organizationName,this.state.userName).then(e=>{this.setState({application:e})})}setReturnUrl(){const t=new URLSearchParams(this.props.location.search).get("returnUrl");t!==null&&this.setState({returnUrl:t})}parseUserField(e,t){return t}updateUserField(e,t){t=this.parseUserField(e,t);const i=this.state.user;i[e]=t,this.setState({user:i})}unlinked(){this.getUser()}isSelf(){var e;return this.state.user.id===((e=this.props.account)==null?void 0:e.id)}isSelfOrAdmin(){return this.isSelf()||_e(this.props.account)}getCountryCode(){return this.props.account.countryCode}renderAccountItem(e){var n,r,s,h,u;if(!e.visible)return null;const t=_e(this.props.account);if(e.viewRule==="Self"){if(!this.isSelfOrAdmin())return null}else if(e.viewRule==="Admin"&&!t)return null;let i=!1;if(e.modifyRule==="Self"?this.isSelfOrAdmin()||(i=!0):e.modifyRule==="Admin"?t||(i=!0):e.modifyRule==="Immutable"&&(i=!0),e.name==="Organization")return m(E,{style:{marginTop:"10px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Organization"),p.t("general:Organization - Tooltip"))," :"]}),d(v,{span:22,children:d(re,{virtual:!1,style:{width:"100%"},disabled:i,value:this.state.user.owner,onChange:o=>{this.getApplicationsByOrganization(o),this.updateUserField("owner",o)},children:this.state.organizations.map((o,l)=>d(ka,{value:o.name,children:o.name},l))})})]});if(e.name==="ID")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N("ID",p.t("general:ID - Tooltip"))," :"]}),d(v,{span:22,children:d(Y,{value:this.state.user.id,disabled:i})})]});if(e.name==="Name")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Name"),p.t("general:Name - Tooltip"))," :"]}),d(v,{span:22,children:d(Y,{value:this.state.user.name,disabled:i,onChange:o=>{this.updateUserField("name",o.target.value)}})})]});if(e.name==="Display name")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Display name"),p.t("general:Display name - Tooltip"))," :"]}),d(v,{span:22,children:d(Y,{value:this.state.user.displayName,onChange:o=>{this.updateUserField("displayName",o.target.value)}})})]});if(e.name==="Avatar")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Avatar"),p.t("general:Avatar - Tooltip"))," :"]}),m(v,{span:22,children:[m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[p.t("general:Preview"),":"]}),d(v,{span:22,children:d("a",{target:"_blank",rel:"noreferrer",href:this.state.user.avatar,children:d("img",{src:this.state.user.avatar,alt:this.state.user.avatar,height:90,style:{marginBottom:"20px"}})})})]}),d(E,{style:{marginTop:"20px"},children:d(Oa,{buttonText:`${p.t("user:Upload a photo")}...`,title:p.t("user:Upload a photo"),user:this.state.user,organization:this.state.organizations.find(o=>o.name===this.state.organizationName)})})]})]});if(e.name==="User type")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:User type"),p.t("general:User type - Tooltip"))," :"]}),d(v,{span:22,children:d(re,{virtual:!1,style:{width:"100%"},value:this.state.user.type,onChange:o=>{this.updateUserField("type",o)},options:["normal-user"].map(o=>Ue(o,o))})})]});if(e.name==="Password")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Password"),p.t("general:Password - Tooltip"))," :"]}),d(v,{span:22,children:d(Ea,{user:this.state.user,account:this.props.account,disabled:i})})]});if(e.name==="Email")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Email"),p.t("general:Email - Tooltip"))," :"]}),d(v,{style:{paddingRight:"20px"},span:11,children:d(Y,{value:this.state.user.email,style:{width:"280Px"},disabled:lt(this.props.account)?i:!0,onChange:o=>{this.updateUserField("email",o.target.value)}})}),d(v,{span:O()?22:11,children:this.isSelf()?d(At,{application:this.state.application,disabled:i,buttonText:p.t("user:Reset Email..."),destType:"email"}):null})]});if(e.name==="Phone")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Phone"),p.t("general:Phone - Tooltip"))," :"]}),d(v,{style:{paddingRight:"20px"},span:11,children:m(Y.Group,{compact:!0,style:{width:"280Px"},children:[d(fi,{style:{width:"30%"},value:this.state.user.countryCode,onChange:o=>{this.updateUserField("countryCode",o)},countryCodes:(n=this.state.application)==null?void 0:n.organizationObj.countryCodes}),d(Y,{value:this.state.user.phone,style:{width:"70%"},disabled:lt(this.props.account)?i:!0,onChange:o=>{this.updateUserField("phone",o.target.value)}})]})}),d(v,{span:O()?24:11,children:this.isSelf()?d(At,{application:this.state.application,countryCode:this.getCountryCode(),disabled:i,buttonText:p.t("user:Reset Phone..."),destType:"phone"}):null})]});if(e.name==="Country/Region")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Country/Region"),p.t("user:Country/Region - Tooltip"))," :"]}),d(v,{span:22,children:d(gi,{defaultValue:this.state.user.region,onChange:o=>{this.updateUserField("region",o)}})})]});if(e.name==="Location")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Location"),p.t("user:Location - Tooltip"))," :"]}),d(v,{span:22,children:d(Y,{value:this.state.user.location,onChange:o=>{this.updateUserField("location",o.target.value)}})})]});if(e.name==="Affiliation")return this.state.application===null||this.state.user===null?null:d(mi,{labelSpan:O()?22:2,application:this.state.application,user:this.state.user,onUpdateUserField:(o,l)=>this.updateUserField(o,l)});if(e.name==="Title")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Title"),p.t("user:Title - Tooltip"))," :"]}),d(v,{span:22,children:d(Y,{value:this.state.user.title,onChange:o=>{this.updateUserField("title",o.target.value)}})})]});if(e.name==="Homepage")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Homepage"),p.t("user:Homepage - Tooltip"))," :"]}),d(v,{span:22,children:d(Y,{value:this.state.user.homepage,onChange:o=>{this.updateUserField("homepage",o.target.value)}})})]});if(e.name==="Bio")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Bio"),p.t("user:Bio - Tooltip"))," :"]}),d(v,{span:22,children:d(Y,{value:this.state.user.bio,onChange:o=>{this.updateUserField("bio",o.target.value)}})})]});if(e.name==="Tag")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Tag"),p.t("user:Tag - Tooltip"))," :"]}),d(v,{span:22,children:((s=(r=this.state.application)==null?void 0:r.organizationObj.tags)==null?void 0:s.length)>0?d(re,{virtual:!1,style:{width:"100%"},value:this.state.user.tag,onChange:o=>{this.updateUserField("tag",o)},options:(h=this.state.application.organizationObj.tags)==null?void 0:h.map(o=>{const l=o.split("|"),c=l[0],f=vi()!=="zh"?l[0]:l[1];return Ue(f,c)})}):d(Y,{value:this.state.user.tag,onChange:o=>{this.updateUserField("tag",o.target.value)}})})]});if(e.name==="Signup application")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Signup application"),p.t("general:Signup application - Tooltip"))," :"]}),d(v,{span:22,children:d(re,{virtual:!1,style:{width:"100%"},disabled:i,value:this.state.user.signupApplication,onChange:o=>{this.updateUserField("signupApplication",o)},options:this.state.applications.map(o=>Ue(o.name,o.name))})})]});if(e.name==="Roles")return m(E,{style:{marginTop:"20px",alignItems:"center"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Roles"),p.t("general:Roles - Tooltip"))," :"]}),d(v,{span:22,children:ct(this.state.user.roles.map(o=>o.name))})]});if(e.name==="Permissions")return m(E,{style:{marginTop:"20px",alignItems:"center"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("general:Permissions"),p.t("general:Permissions - Tooltip"))," :"]}),d(v,{span:22,children:ct(this.state.user.permissions.map(o=>o.name))})]});if(e.name==="3rd-party logins")return this.isSelfOrAdmin()?m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:3rd-party logins"),p.t("user:3rd-party logins - Tooltip"))," :"]}),d(v,{span:22,children:d("div",{style:{marginBottom:20},children:this.state.application===null||this.state.user===null?null:(u=this.state.application)==null?void 0:u.providers.filter(o=>yi(o)).map(o=>o.provider.category==="OAuth"?d(wi,{labelSpan:O()?10:3,user:this.state.user,application:this.state.application,providerItem:o,account:this.props.account,onUnlinked:()=>this.unlinked()},o.name):d(Ma,{labelSpan:O()?10:3,user:this.state.user,application:this.state.application,providerItem:o,onUnlinked:()=>this.unlinked()},o.name))})})]}):null;if(e.name==="Properties")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Properties"),p.t("user:Properties - Tooltip"))," :"]}),d(v,{span:22,children:d(Na,{properties:this.state.user.properties,onUpdateTable:o=>{this.updateUserField("properties",o)}})})]});if(e.name==="Is admin")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Is admin"),p.t("user:Is admin - Tooltip"))," :"]}),d(v,{span:O()?22:2,children:d(Ee,{disabled:i,checked:this.state.user.isAdmin,onChange:o=>{this.updateUserField("isAdmin",o)}})})]});if(e.name==="Is global admin")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Is global admin"),p.t("user:Is global admin - Tooltip"))," :"]}),d(v,{span:O()?22:2,children:d(Ee,{disabled:i,checked:this.state.user.isGlobalAdmin,onChange:o=>{this.updateUserField("isGlobalAdmin",o)}})})]});if(e.name==="Is forbidden")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Is forbidden"),p.t("user:Is forbidden - Tooltip"))," :"]}),d(v,{span:O()?22:2,children:d(Ee,{checked:this.state.user.isForbidden,onChange:o=>{this.updateUserField("isForbidden",o)}})})]});if(e.name==="Is deleted")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Is deleted"),p.t("user:Is deleted - Tooltip"))," :"]}),d(v,{span:O()?22:2,children:d(Ee,{checked:this.state.user.isDeleted,onChange:o=>{this.updateUserField("isDeleted",o)}})})]});if(e.name==="WebAuthn credentials")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:WebAuthn credentials"),p.t("user:WebAuthn credentials"))," :"]}),d(v,{span:22,children:d(Sa,{isSelf:this.isSelf(),table:this.state.user.webauthnCredentials,updateTable:o=>{this.updateUserField("webauthnCredentials",o)},refresh:this.getUser.bind(this)})})]});if(e.name==="Managed accounts")return m(E,{style:{marginTop:"20px"},children:[m(v,{style:{marginTop:"5px"},span:O()?22:2,children:[N(p.t("user:Managed accounts"),p.t("user:Managed accounts"))," :"]}),d(v,{span:22,children:d(Ra,{title:p.t("user:Managed accounts"),table:this.state.user.managedAccounts,onUpdateTable:o=>{this.updateUserField("managedAccounts",o)},applications:this.state.applications})})]})}renderUser(){var e,t;return d(xi,{size:"small",title:m("div",{children:[this.state.mode==="add"?p.t("user:New User"):p.t("user:Edit User"),"    ",d(W,{onClick:()=>this.submitUserEdit(!1),children:p.t("general:Save")}),d(W,{style:{marginLeft:"20px"},type:"primary",onClick:()=>this.submitUserEdit(!0),children:p.t("general:Save & Exit")}),this.state.mode==="add"?d(W,{style:{marginLeft:"20px"},onClick:()=>this.deleteUser(),children:p.t("general:Cancel")}):null]}),style:O()?{margin:"5px"}:{},type:"inner",children:(t=(e=this.state.application)==null?void 0:e.organizationObj.accountItems)==null?void 0:t.map(i=>d(I.Fragment,{children:this.renderAccountItem(i)},i.name))})}submitUserEdit(e){const t=kt(this.state.user);bi(this.state.organizationName,this.state.userName,t).then(i=>{i.status==="ok"?(X("success",p.t("general:Successfully saved")),this.setState({organizationName:this.state.user.owner,userName:this.state.user.name}),this.props.history!==void 0?e?this.props.history.push("/users"):this.props.history.push(`/users/${this.state.user.owner}/${this.state.user.name}`):e&&this.state.returnUrl&&(window.location.href=this.state.returnUrl)):(X("error",`${p.t("general:Failed to save")}: ${i.msg}`),this.updateUserField("owner",this.state.organizationName),this.updateUserField("name",this.state.userName))}).catch(i=>{X("error",`${p.t("general:Failed to connect to server")}: ${i}`)})}deleteUser(){Ti(this.state.user).then(e=>{e.status==="ok"?this.props.history.push("/users"):X("error",`${p.t("general:Failed to delete")}: ${e.msg}`)}).catch(e=>{X("error",`${p.t("general:Failed to connect to server")}: ${e}`)})}render(){return m("div",{children:[this.state.loading?d(Ci,{size:"large",style:{marginLeft:"50%",marginTop:"10%"}}):this.state.user!==null?this.renderUser():d(Di,{status:"404",title:"404 NOT FOUND",subTitle:p.t("general:Sorry, the user you visited does not exist or you are not authorized to access this user."),extra:d("a",{href:"/",children:d(W,{type:"primary",children:p.t("general:Back Home")})})}),this.state.user===null?null:m("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[d(W,{size:"large",onClick:()=>this.submitUserEdit(!1),children:p.t("general:Save")}),d(W,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:()=>this.submitUserEdit(!0),children:p.t("general:Save & Exit")}),this.state.mode==="add"?d(W,{style:{marginLeft:"20px"},size:"large",onClick:()=>this.deleteUser(),children:p.t("general:Cancel")}):null]})]})}}export{Ya as default};
