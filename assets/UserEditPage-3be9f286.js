var Jt=Object.defineProperty;var ei=(a,e,t)=>e in a?Jt(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var me=(a,e,t)=>(ei(a,typeof e!="symbol"?e+"":e,t),t);import{ag as $,ah as At,ai as Me,R as B,j as o,B as I,co as qe,i as p,n as m,m as D,q as ae,s as H,O as Le,I as W,cz as ti,a9 as ii,cA as ai,cB as ri,cC as si,cD as ni,e as j,b as Ke,cE as oi,E as Rt,k as Nt,p as ot,T as ke,D as hi,cF as li,f as ci,u as di,cG as pi,w as A,x as ze,Y as ht,a7 as ui,cH as fi,cI as gi,N as mi,V as lt,cJ as vi,cK as xi,v as yi,cL as wi,K as bi,cn as Ti,as as Ci}from"./index-f0baa7a0.js";import{g as ji,u as Di}from"./ResourceBackend-1b97151f.js";import{T as Ze}from"./Table-f650b5e6.js";import{U as Oi}from"./UpOutlined-edefe85e.js";import{D as kt}from"./DeleteOutlined-7482b196.js";import{S as De}from"./index-821d4c24.js";import"./UpOutlined-7082c42f.js";import"./DeleteOutlined-25685737.js";var Ei={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"};const Mi=Ei;var Si={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M877.1 238.7L770.6 132.3c-13-13-30.4-20.3-48.8-20.3s-35.8 7.2-48.8 20.3L558.3 246.8c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l89.6 89.7a405.46 405.46 0 01-86.4 127.3c-36.7 36.9-79.6 66-127.2 86.6l-89.6-89.7c-13-13-30.4-20.3-48.8-20.3a68.2 68.2 0 00-48.8 20.3L132.3 673c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l106.4 106.4c22.2 22.2 52.8 34.9 84.2 34.9 6.5 0 12.8-.5 19.2-1.6 132.4-21.8 263.8-92.3 369.9-198.3C818 606 888.4 474.6 910.4 342.1c6.3-37.6-6.3-76.3-33.3-103.4zm-37.6 91.5c-19.5 117.9-82.9 235.5-178.4 331s-213 158.9-330.9 178.4c-14.8 2.5-30-2.5-40.8-13.2L184.9 721.9 295.7 611l119.8 120 .9.9 21.6-8a481.29 481.29 0 00285.7-285.8l8-21.6-120.8-120.7 110.8-110.9 104.5 104.5c10.8 10.8 15.8 26 13.3 40.8z"}}]},name:"phone",theme:"outlined"};const Ai=Si;var zt=function(e,t){return $.createElement(At,Me(Me({},e),{},{ref:t,icon:Mi}))};zt.displayName="MailOutlined";const Ri=$.forwardRef(zt);var Pt=function(e,t){return $.createElement(At,Me(Me({},e),{},{ref:t,icon:Ai}))};Pt.displayName="PhoneOutlined";const Ni=$.forwardRef(Pt);/*!
 * Cropper.js v1.5.13
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2022-11-20T05:30:46.114Z
 */function ct(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),t.push.apply(t,i)}return t}function Ut(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ct(Object(t),!0).forEach(function(i){Pi(a,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):ct(Object(t)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(t,i))})}return a}function Ie(a){return Ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(a)}function ki(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function dt(a,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}function zi(a,e,t){return e&&dt(a.prototype,e),t&&dt(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function Pi(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function Bt(a){return Ui(a)||Bi(a)||Li(a)||Ii()}function Ui(a){if(Array.isArray(a))return _e(a)}function Bi(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Li(a,e){if(a){if(typeof a=="string")return _e(a,e);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _e(a,e)}}function _e(a,e){(e==null||e>a.length)&&(e=a.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=a[t];return i}function Ii(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Re=typeof window<"u"&&typeof window.document<"u",ee=Re?window:{},Qe=Re&&ee.document.documentElement?"ontouchstart"in ee.document.documentElement:!1,Je=Re?"PointerEvent"in ee:!1,N="cropper",et="all",Lt="crop",It="move",_t="zoom",oe="e",he="w",de="s",te="n",ve="ne",xe="nw",ye="se",we="sw",We="".concat(N,"-crop"),pt="".concat(N,"-disabled"),q="".concat(N,"-hidden"),ut="".concat(N,"-hide"),_i="".concat(N,"-invisible"),Se="".concat(N,"-modal"),He="".concat(N,"-move"),Ce="".concat(N,"Action"),Oe="".concat(N,"Preview"),tt="crop",Wt="move",Ht="none",Ye="crop",Xe="cropend",Fe="cropmove",$e="cropstart",ft="dblclick",Wi=Qe?"touchstart":"mousedown",Hi=Qe?"touchmove":"mousemove",Yi=Qe?"touchend touchcancel":"mouseup",gt=Je?"pointerdown":Wi,mt=Je?"pointermove":Hi,vt=Je?"pointerup pointercancel":Yi,xt="ready",yt="resize",wt="wheel",Ve="zoom",bt="image/jpeg",Xi=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Fi=/^data:/,$i=/^data:image\/jpeg;base64,/,Vi=/^img|canvas$/i,Yt=200,Xt=100,Tt={viewMode:0,dragMode:tt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Yt,minContainerHeight:Xt,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Gi='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',qi=Number.isNaN||ee.isNaN;function O(a){return typeof a=="number"&&!qi(a)}var Ct=function(e){return e>0&&e<1/0};function Pe(a){return typeof a>"u"}function le(a){return Ie(a)==="object"&&a!==null}var Ki=Object.prototype.hasOwnProperty;function pe(a){if(!le(a))return!1;try{var e=a.constructor,t=e.prototype;return e&&t&&Ki.call(t,"isPrototypeOf")}catch{return!1}}function G(a){return typeof a=="function"}var Zi=Array.prototype.slice;function Ft(a){return Array.from?Array.from(a):Zi.call(a)}function _(a,e){return a&&G(e)&&(Array.isArray(a)||O(a.length)?Ft(a).forEach(function(t,i){e.call(a,t,i,a)}):le(a)&&Object.keys(a).forEach(function(t){e.call(a,a[t],t,a)})),a}var k=Object.assign||function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return le(e)&&i.length>0&&i.forEach(function(r){le(r)&&Object.keys(r).forEach(function(n){e[n]=r[n]})}),e},Qi=/\.\d*(?:0|9){12}\d*$/;function fe(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Qi.test(a)?Math.round(a*e)/e:a}var Ji=/^width|height|left|top|marginLeft|marginTop$/;function re(a,e){var t=a.style;_(e,function(i,s){Ji.test(s)&&O(i)&&(i="".concat(i,"px")),t[s]=i})}function ea(a,e){return a.classList?a.classList.contains(e):a.className.indexOf(e)>-1}function X(a,e){if(e){if(O(a.length)){_(a,function(i){X(i,e)});return}if(a.classList){a.classList.add(e);return}var t=a.className.trim();t?t.indexOf(e)<0&&(a.className="".concat(t," ").concat(e)):a.className=e}}function J(a,e){if(e){if(O(a.length)){_(a,function(t){J(t,e)});return}if(a.classList){a.classList.remove(e);return}a.className.indexOf(e)>=0&&(a.className=a.className.replace(e,""))}}function ue(a,e,t){if(e){if(O(a.length)){_(a,function(i){ue(i,e,t)});return}t?X(a,e):J(a,e)}}var ta=/([a-z\d])([A-Z])/g;function it(a){return a.replace(ta,"$1-$2").toLowerCase()}function Ge(a,e){return le(a[e])?a[e]:a.dataset?a.dataset[e]:a.getAttribute("data-".concat(it(e)))}function je(a,e,t){le(t)?a[e]=t:a.dataset?a.dataset[e]=t:a.setAttribute("data-".concat(it(e)),t)}function ia(a,e){if(le(a[e]))try{delete a[e]}catch{a[e]=void 0}else if(a.dataset)try{delete a.dataset[e]}catch{a.dataset[e]=void 0}else a.removeAttribute("data-".concat(it(e)))}var $t=/\s\s*/,Vt=function(){var a=!1;if(Re){var e=!1,t=function(){},i=Object.defineProperty({},"once",{get:function(){return a=!0,e},set:function(r){e=r}});ee.addEventListener("test",t,i),ee.removeEventListener("test",t,i)}return a}();function Z(a,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=t;e.trim().split($t).forEach(function(r){if(!Vt){var n=a.listeners;n&&n[r]&&n[r][t]&&(s=n[r][t],delete n[r][t],Object.keys(n[r]).length===0&&delete n[r],Object.keys(n).length===0&&delete a.listeners)}a.removeEventListener(r,s,i)})}function K(a,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=t;e.trim().split($t).forEach(function(r){if(i.once&&!Vt){var n=a.listeners,l=n===void 0?{}:n;s=function(){delete l[r][t],a.removeEventListener(r,s,i);for(var h=arguments.length,c=new Array(h),d=0;d<h;d++)c[d]=arguments[d];t.apply(a,c)},l[r]||(l[r]={}),l[r][t]&&a.removeEventListener(r,l[r][t],i),l[r][t]=s,a.listeners=l}a.addEventListener(r,s,i)})}function ge(a,e,t){var i;return G(Event)&&G(CustomEvent)?i=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent"),i.initCustomEvent(e,!0,!0,t)),a.dispatchEvent(i)}function Gt(a){var e=a.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ue=ee.location,aa=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function jt(a){var e=a.match(aa);return e!==null&&(e[1]!==Ue.protocol||e[2]!==Ue.hostname||e[3]!==Ue.port)}function Dt(a){var e="timestamp=".concat(new Date().getTime());return a+(a.indexOf("?")===-1?"?":"&")+e}function Te(a){var e=a.rotate,t=a.scaleX,i=a.scaleY,s=a.translateX,r=a.translateY,n=[];O(s)&&s!==0&&n.push("translateX(".concat(s,"px)")),O(r)&&r!==0&&n.push("translateY(".concat(r,"px)")),O(e)&&e!==0&&n.push("rotate(".concat(e,"deg)")),O(t)&&t!==1&&n.push("scaleX(".concat(t,")")),O(i)&&i!==1&&n.push("scaleY(".concat(i,")"));var l=n.length?n.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function ra(a){var e=Ut({},a),t=0;return _(a,function(i,s){delete e[s],_(e,function(r){var n=Math.abs(i.startX-r.startX),l=Math.abs(i.startY-r.startY),u=Math.abs(i.endX-r.endX),h=Math.abs(i.endY-r.endY),c=Math.sqrt(n*n+l*l),d=Math.sqrt(u*u+h*h),f=(d-c)/c;Math.abs(f)>Math.abs(t)&&(t=f)})}),t}function Ee(a,e){var t=a.pageX,i=a.pageY,s={endX:t,endY:i};return e?s:Ut({startX:t,startY:i},s)}function sa(a){var e=0,t=0,i=0;return _(a,function(s){var r=s.startX,n=s.startY;e+=r,t+=n,i+=1}),e/=i,t/=i,{pageX:e,pageY:t}}function se(a){var e=a.aspectRatio,t=a.height,i=a.width,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",r=Ct(i),n=Ct(t);if(r&&n){var l=t*e;s==="contain"&&l>i||s==="cover"&&l<i?t=i/e:i=t*e}else r?t=i/e:n&&(i=t*e);return{width:i,height:t}}function na(a){var e=a.width,t=a.height,i=a.degree;if(i=Math.abs(i)%180,i===90)return{width:t,height:e};var s=i%90*Math.PI/180,r=Math.sin(s),n=Math.cos(s),l=e*n+t*r,u=e*r+t*n;return i>90?{width:u,height:l}:{width:l,height:u}}function oa(a,e,t,i){var s=e.aspectRatio,r=e.naturalWidth,n=e.naturalHeight,l=e.rotate,u=l===void 0?0:l,h=e.scaleX,c=h===void 0?1:h,d=e.scaleY,f=d===void 0?1:d,y=t.aspectRatio,v=t.naturalWidth,E=t.naturalHeight,w=i.fillColor,T=w===void 0?"transparent":w,z=i.imageSmoothingEnabled,R=z===void 0?!0:z,U=i.imageSmoothingQuality,F=U===void 0?"low":U,g=i.maxWidth,x=g===void 0?1/0:g,C=i.maxHeight,M=C===void 0?1/0:C,b=i.minWidth,P=b===void 0?0:b,S=i.minHeight,L=S===void 0?0:S,V=document.createElement("canvas"),Y=V.getContext("2d"),Q=se({aspectRatio:y,width:x,height:M}),ne=se({aspectRatio:y,width:P,height:L},"cover"),ce=Math.min(Q.width,Math.max(ne.width,v)),Ne=Math.min(Q.height,Math.max(ne.height,E)),at=se({aspectRatio:s,width:x,height:M}),rt=se({aspectRatio:s,width:P,height:L},"cover"),st=Math.min(at.width,Math.max(rt.width,r)),nt=Math.min(at.height,Math.max(rt.height,n)),Zt=[-st/2,-nt/2,st,nt];return V.width=fe(ce),V.height=fe(Ne),Y.fillStyle=T,Y.fillRect(0,0,ce,Ne),Y.save(),Y.translate(ce/2,Ne/2),Y.rotate(u*Math.PI/180),Y.scale(c,f),Y.imageSmoothingEnabled=R,Y.imageSmoothingQuality=F,Y.drawImage.apply(Y,[a].concat(Bt(Zt.map(function(Qt){return Math.floor(fe(Qt))})))),Y.restore(),V}var qt=String.fromCharCode;function ha(a,e,t){var i="";t+=e;for(var s=e;s<t;s+=1)i+=qt(a.getUint8(s));return i}var la=/^data:.*,/;function ca(a){var e=a.replace(la,""),t=atob(e),i=new ArrayBuffer(t.length),s=new Uint8Array(i);return _(s,function(r,n){s[n]=t.charCodeAt(n)}),i}function da(a,e){for(var t=[],i=8192,s=new Uint8Array(a);s.length>0;)t.push(qt.apply(null,Ft(s.subarray(0,i)))),s=s.subarray(i);return"data:".concat(e,";base64,").concat(btoa(t.join("")))}function pa(a){var e=new DataView(a),t;try{var i,s,r;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var n=e.byteLength,l=2;l+1<n;){if(e.getUint8(l)===255&&e.getUint8(l+1)===225){s=l;break}l+=1}if(s){var u=s+4,h=s+10;if(ha(e,u,4)==="Exif"){var c=e.getUint16(h);if(i=c===18761,(i||c===19789)&&e.getUint16(h+2,i)===42){var d=e.getUint32(h+4,i);d>=8&&(r=h+d)}}}if(r){var f=e.getUint16(r,i),y,v;for(v=0;v<f;v+=1)if(y=r+v*12+2,e.getUint16(y,i)===274){y+=8,t=e.getUint16(y,i),e.setUint16(y,1,i);break}}}catch{t=1}return t}function ua(a){var e=0,t=1,i=1;switch(a){case 2:t=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:i}}var fa={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,i=this.container,s=this.cropper,r=Number(t.minContainerWidth),n=Number(t.minContainerHeight);X(s,q),J(e,q);var l={width:Math.max(i.offsetWidth,r>=0?r:Yt),height:Math.max(i.offsetHeight,n>=0?n:Xt)};this.containerData=l,re(s,{width:l.width,height:l.height}),X(e,q),J(s,q)},initCanvas:function(){var e=this.containerData,t=this.imageData,i=this.options.viewMode,s=Math.abs(t.rotate)%180===90,r=s?t.naturalHeight:t.naturalWidth,n=s?t.naturalWidth:t.naturalHeight,l=r/n,u=e.width,h=e.height;e.height*l>e.width?i===3?u=e.height*l:h=e.width/l:i===3?h=e.width/l:u=e.height*l;var c={aspectRatio:l,naturalWidth:r,naturalHeight:n,width:u,height:h};this.canvasData=c,this.limited=i===1||i===2,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(e.width-c.width)/2,c.top=(e.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=k({},c)},limitCanvas:function(e,t){var i=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=i.viewMode,u=r.aspectRatio,h=this.cropped&&n;if(e){var c=Number(i.minCanvasWidth)||0,d=Number(i.minCanvasHeight)||0;l>1?(c=Math.max(c,s.width),d=Math.max(d,s.height),l===3&&(d*u>c?c=d*u:d=c/u)):l>0&&(c?c=Math.max(c,h?n.width:0):d?d=Math.max(d,h?n.height:0):h&&(c=n.width,d=n.height,d*u>c?c=d*u:d=c/u));var f=se({aspectRatio:u,width:c,height:d});c=f.width,d=f.height,r.minWidth=c,r.minHeight=d,r.maxWidth=1/0,r.maxHeight=1/0}if(t)if(l>(h?0:1)){var y=s.width-r.width,v=s.height-r.height;r.minLeft=Math.min(0,y),r.minTop=Math.min(0,v),r.maxLeft=Math.max(0,y),r.maxTop=Math.max(0,v),h&&this.limited&&(r.minLeft=Math.min(n.left,n.left+(n.width-r.width)),r.minTop=Math.min(n.top,n.top+(n.height-r.height)),r.maxLeft=n.left,r.maxTop=n.top,l===2&&(r.width>=s.width&&(r.minLeft=Math.min(0,y),r.maxLeft=Math.max(0,y)),r.height>=s.height&&(r.minTop=Math.min(0,v),r.maxTop=Math.max(0,v))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=s.width,r.maxTop=s.height},renderCanvas:function(e,t){var i=this.canvasData,s=this.imageData;if(t){var r=na({width:s.naturalWidth*Math.abs(s.scaleX||1),height:s.naturalHeight*Math.abs(s.scaleY||1),degree:s.rotate||0}),n=r.width,l=r.height,u=i.width*(n/i.naturalWidth),h=i.height*(l/i.naturalHeight);i.left-=(u-i.width)/2,i.top-=(h-i.height)/2,i.width=u,i.height=h,i.aspectRatio=n/l,i.naturalWidth=n,i.naturalHeight=l,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,re(this.canvas,k({width:i.width,height:i.height},Te({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,i=this.imageData,s=i.naturalWidth*(t.width/t.naturalWidth),r=i.naturalHeight*(t.height/t.naturalHeight);k(i,{width:s,height:r,left:(t.width-s)/2,top:(t.height-r)/2}),re(this.image,k({width:i.width,height:i.height},Te(k({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,s=Number(e.autoCropArea)||.8,r={width:t.width,height:t.height};i&&(t.height*i>t.width?r.height=r.width/i:r.width=r.height*i),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*s),r.height=Math.max(r.minHeight,r.height*s),r.left=t.left+(t.width-r.width)/2,r.top=t.top+(t.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=k({},r)},limitCropBox:function(e,t){var i=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=this.limited,u=i.aspectRatio;if(e){var h=Number(i.minCropBoxWidth)||0,c=Number(i.minCropBoxHeight)||0,d=l?Math.min(s.width,r.width,r.width+r.left,s.width-r.left):s.width,f=l?Math.min(s.height,r.height,r.height+r.top,s.height-r.top):s.height;h=Math.min(h,s.width),c=Math.min(c,s.height),u&&(h&&c?c*u>h?c=h/u:h=c*u:h?c=h/u:c&&(h=c*u),f*u>d?f=d/u:d=f*u),n.minWidth=Math.min(h,d),n.minHeight=Math.min(c,f),n.maxWidth=d,n.maxHeight=f}t&&(l?(n.minLeft=Math.max(0,r.left),n.minTop=Math.max(0,r.top),n.maxLeft=Math.min(s.width,r.left+r.width)-n.width,n.maxTop=Math.min(s.height,r.top+r.height)-n.height):(n.minLeft=0,n.minTop=0,n.maxLeft=s.width-n.width,n.maxTop=s.height-n.height))},renderCropBox:function(){var e=this.options,t=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&je(this.face,Ce,i.width>=t.width&&i.height>=t.height?It:et),re(this.cropBox,k({width:i.width,height:i.height},Te({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),ge(this.element,Ye,this.getData())}},ga={initPreview:function(){var e=this.element,t=this.crossOrigin,i=this.options.preview,s=t?this.crossOriginUrl:this.url,r=e.alt||"The image to preview",n=document.createElement("img");if(t&&(n.crossOrigin=t),n.src=s,n.alt=r,this.viewBox.appendChild(n),this.viewBoxImage=n,!!i){var l=i;typeof i=="string"?l=e.ownerDocument.querySelectorAll(i):i.querySelector&&(l=[i]),this.previews=l,_(l,function(u){var h=document.createElement("img");je(u,Oe,{width:u.offsetWidth,height:u.offsetHeight,html:u.innerHTML}),t&&(h.crossOrigin=t),h.src=s,h.alt=r,h.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',u.innerHTML="",u.appendChild(h)})}},resetPreview:function(){_(this.previews,function(e){var t=Ge(e,Oe);re(e,{width:t.width,height:t.height}),e.innerHTML=t.html,ia(e,Oe)})},preview:function(){var e=this.imageData,t=this.canvasData,i=this.cropBoxData,s=i.width,r=i.height,n=e.width,l=e.height,u=i.left-t.left-e.left,h=i.top-t.top-e.top;!this.cropped||this.disabled||(re(this.viewBoxImage,k({width:n,height:l},Te(k({translateX:-u,translateY:-h},e)))),_(this.previews,function(c){var d=Ge(c,Oe),f=d.width,y=d.height,v=f,E=y,w=1;s&&(w=f/s,E=r*w),r&&E>y&&(w=y/r,v=s*w,E=y),re(c,{width:v,height:E}),re(c.getElementsByTagName("img")[0],k({width:n*w,height:l*w},Te(k({translateX:-u*w,translateY:-h*w},e))))}))}},ma={bind:function(){var e=this.element,t=this.options,i=this.cropper;G(t.cropstart)&&K(e,$e,t.cropstart),G(t.cropmove)&&K(e,Fe,t.cropmove),G(t.cropend)&&K(e,Xe,t.cropend),G(t.crop)&&K(e,Ye,t.crop),G(t.zoom)&&K(e,Ve,t.zoom),K(i,gt,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&K(i,wt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&K(i,ft,this.onDblclick=this.dblclick.bind(this)),K(e.ownerDocument,mt,this.onCropMove=this.cropMove.bind(this)),K(e.ownerDocument,vt,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&K(window,yt,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,i=this.cropper;G(t.cropstart)&&Z(e,$e,t.cropstart),G(t.cropmove)&&Z(e,Fe,t.cropmove),G(t.cropend)&&Z(e,Xe,t.cropend),G(t.crop)&&Z(e,Ye,t.crop),G(t.zoom)&&Z(e,Ve,t.zoom),Z(i,gt,this.onCropStart),t.zoomable&&t.zoomOnWheel&&Z(i,wt,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Z(i,ft,this.onDblclick),Z(e.ownerDocument,mt,this.onCropMove),Z(e.ownerDocument,vt,this.onCropEnd),t.responsive&&Z(window,yt,this.onResize)}},va={resize:function(){if(!this.disabled){var e=this.options,t=this.container,i=this.containerData,s=t.offsetWidth/i.width,r=t.offsetHeight/i.height,n=Math.abs(s-1)>Math.abs(r-1)?s:r;if(n!==1){var l,u;e.restore&&(l=this.getCanvasData(),u=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(_(l,function(h,c){l[c]=h*n})),this.setCropBoxData(_(u,function(h,c){u[c]=h*n})))}}},dblclick:function(){this.disabled||this.options.dragMode===Ht||this.setDragMode(ea(this.dragBox,We)?Wt:tt)},wheel:function(e){var t=this,i=Number(this.options.wheelZoomRatio)||.1,s=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?s=e.deltaY>0?1:-1:e.wheelDelta?s=-e.wheelDelta/120:e.detail&&(s=e.detail>0?1:-1),this.zoom(-s*i,e)))},cropStart:function(e){var t=e.buttons,i=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(O(t)&&t!==1||O(i)&&i!==0||e.ctrlKey))){var s=this.options,r=this.pointers,n;e.changedTouches?_(e.changedTouches,function(l){r[l.identifier]=Ee(l)}):r[e.pointerId||0]=Ee(e),Object.keys(r).length>1&&s.zoomable&&s.zoomOnTouch?n=_t:n=Ge(e.target,Ce),Xi.test(n)&&ge(this.element,$e,{originalEvent:e,action:n})!==!1&&(e.preventDefault(),this.action=n,this.cropping=!1,n===Lt&&(this.cropping=!0,X(this.dragBox,Se)))}},cropMove:function(e){var t=this.action;if(!(this.disabled||!t)){var i=this.pointers;e.preventDefault(),ge(this.element,Fe,{originalEvent:e,action:t})!==!1&&(e.changedTouches?_(e.changedTouches,function(s){k(i[s.identifier]||{},Ee(s,!0))}):k(i[e.pointerId||0]||{},Ee(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,i=this.pointers;e.changedTouches?_(e.changedTouches,function(s){delete i[s.identifier]}):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,ue(this.dragBox,Se,this.cropped&&this.options.modal)),ge(this.element,Xe,{originalEvent:e,action:t}))}}},xa={change:function(e){var t=this.options,i=this.canvasData,s=this.containerData,r=this.cropBoxData,n=this.pointers,l=this.action,u=t.aspectRatio,h=r.left,c=r.top,d=r.width,f=r.height,y=h+d,v=c+f,E=0,w=0,T=s.width,z=s.height,R=!0,U;!u&&e.shiftKey&&(u=d&&f?d/f:1),this.limited&&(E=r.minLeft,w=r.minTop,T=E+Math.min(s.width,i.width,i.left+i.width),z=w+Math.min(s.height,i.height,i.top+i.height));var F=n[Object.keys(n)[0]],g={x:F.endX-F.startX,y:F.endY-F.startY},x=function(M){switch(M){case oe:y+g.x>T&&(g.x=T-y);break;case he:h+g.x<E&&(g.x=E-h);break;case te:c+g.y<w&&(g.y=w-c);break;case de:v+g.y>z&&(g.y=z-v);break}};switch(l){case et:h+=g.x,c+=g.y;break;case oe:if(g.x>=0&&(y>=T||u&&(c<=w||v>=z))){R=!1;break}x(oe),d+=g.x,d<0&&(l=he,d=-d,h-=d),u&&(f=d/u,c+=(r.height-f)/2);break;case te:if(g.y<=0&&(c<=w||u&&(h<=E||y>=T))){R=!1;break}x(te),f-=g.y,c+=g.y,f<0&&(l=de,f=-f,c-=f),u&&(d=f*u,h+=(r.width-d)/2);break;case he:if(g.x<=0&&(h<=E||u&&(c<=w||v>=z))){R=!1;break}x(he),d-=g.x,h+=g.x,d<0&&(l=oe,d=-d,h-=d),u&&(f=d/u,c+=(r.height-f)/2);break;case de:if(g.y>=0&&(v>=z||u&&(h<=E||y>=T))){R=!1;break}x(de),f+=g.y,f<0&&(l=te,f=-f,c-=f),u&&(d=f*u,h+=(r.width-d)/2);break;case ve:if(u){if(g.y<=0&&(c<=w||y>=T)){R=!1;break}x(te),f-=g.y,c+=g.y,d=f*u}else x(te),x(oe),g.x>=0?y<T?d+=g.x:g.y<=0&&c<=w&&(R=!1):d+=g.x,g.y<=0?c>w&&(f-=g.y,c+=g.y):(f-=g.y,c+=g.y);d<0&&f<0?(l=we,f=-f,d=-d,c-=f,h-=d):d<0?(l=xe,d=-d,h-=d):f<0&&(l=ye,f=-f,c-=f);break;case xe:if(u){if(g.y<=0&&(c<=w||h<=E)){R=!1;break}x(te),f-=g.y,c+=g.y,d=f*u,h+=r.width-d}else x(te),x(he),g.x<=0?h>E?(d-=g.x,h+=g.x):g.y<=0&&c<=w&&(R=!1):(d-=g.x,h+=g.x),g.y<=0?c>w&&(f-=g.y,c+=g.y):(f-=g.y,c+=g.y);d<0&&f<0?(l=ye,f=-f,d=-d,c-=f,h-=d):d<0?(l=ve,d=-d,h-=d):f<0&&(l=we,f=-f,c-=f);break;case we:if(u){if(g.x<=0&&(h<=E||v>=z)){R=!1;break}x(he),d-=g.x,h+=g.x,f=d/u}else x(de),x(he),g.x<=0?h>E?(d-=g.x,h+=g.x):g.y>=0&&v>=z&&(R=!1):(d-=g.x,h+=g.x),g.y>=0?v<z&&(f+=g.y):f+=g.y;d<0&&f<0?(l=ve,f=-f,d=-d,c-=f,h-=d):d<0?(l=ye,d=-d,h-=d):f<0&&(l=xe,f=-f,c-=f);break;case ye:if(u){if(g.x>=0&&(y>=T||v>=z)){R=!1;break}x(oe),d+=g.x,f=d/u}else x(de),x(oe),g.x>=0?y<T?d+=g.x:g.y>=0&&v>=z&&(R=!1):d+=g.x,g.y>=0?v<z&&(f+=g.y):f+=g.y;d<0&&f<0?(l=xe,f=-f,d=-d,c-=f,h-=d):d<0?(l=we,d=-d,h-=d):f<0&&(l=ve,f=-f,c-=f);break;case It:this.move(g.x,g.y),R=!1;break;case _t:this.zoom(ra(n),e),R=!1;break;case Lt:if(!g.x||!g.y){R=!1;break}U=Gt(this.cropper),h=F.startX-U.left,c=F.startY-U.top,d=r.minWidth,f=r.minHeight,g.x>0?l=g.y>0?ye:ve:g.x<0&&(h-=d,l=g.y>0?we:xe),g.y<0&&(c-=f),this.cropped||(J(this.cropBox,q),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}R&&(r.width=d,r.height=f,r.left=h,r.top=c,this.action=l,this.renderCropBox()),_(n,function(C){C.startX=C.endX,C.startY=C.endY})}},ya={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&X(this.dragBox,Se),J(this.cropBox,q),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=k({},this.initialImageData),this.canvasData=k({},this.initialCanvasData),this.cropBoxData=k({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(k(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),J(this.dragBox,Se),X(this.cropBox,q)),this},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,_(this.previews,function(i){i.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,J(this.cropper,pt)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,X(this.cropper,pt)),this},destroy:function(){var e=this.element;return e[N]?(e[N]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,s=i.left,r=i.top;return this.moveTo(Pe(e)?e:s+Number(e),Pe(t)?t:r+Number(t))},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,s=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(O(e)&&(i.left=e,s=!0),O(t)&&(i.top=t,s=!0),s&&this.renderCanvas(!0)),this},zoom:function(e,t){var i=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo:function(e,t,i){var s=this.options,r=this.canvasData,n=r.width,l=r.height,u=r.naturalWidth,h=r.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&s.zoomable){var c=u*e,d=h*e;if(ge(this.element,Ve,{ratio:e,oldRatio:n/u,originalEvent:i})===!1)return this;if(i){var f=this.pointers,y=Gt(this.cropper),v=f&&Object.keys(f).length?sa(f):{pageX:i.pageX,pageY:i.pageY};r.left-=(c-n)*((v.pageX-y.left-r.left)/n),r.top-=(d-l)*((v.pageY-y.top-r.top)/l)}else pe(t)&&O(t.x)&&O(t.y)?(r.left-=(c-n)*((t.x-r.left)/n),r.top-=(d-l)*((t.y-r.top)/l)):(r.left-=(c-n)/2,r.top-=(d-l)/2);r.width=c,r.height=d,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),O(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,O(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(O(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.imageData,s=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(O(e)&&(i.scaleX=e,s=!0),O(t)&&(i.scaleY=t,s=!0),s&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.options,i=this.imageData,s=this.canvasData,r=this.cropBoxData,n;if(this.ready&&this.cropped){n={x:r.left-s.left,y:r.top-s.top,width:r.width,height:r.height};var l=i.width/i.naturalWidth;if(_(n,function(c,d){n[d]=c/l}),e){var u=Math.round(n.y+n.height),h=Math.round(n.x+n.width);n.x=Math.round(n.x),n.y=Math.round(n.y),n.width=h-n.x,n.height=u-n.y}}else n={x:0,y:0,width:0,height:0};return t.rotatable&&(n.rotate=i.rotate||0),t.scalable&&(n.scaleX=i.scaleX||1,n.scaleY=i.scaleY||1),n},setData:function(e){var t=this.options,i=this.imageData,s=this.canvasData,r={};if(this.ready&&!this.disabled&&pe(e)){var n=!1;t.rotatable&&O(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,n=!0),t.scalable&&(O(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,n=!0),O(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,n=!0)),n&&this.renderCanvas(!0,!0);var l=i.width/i.naturalWidth;O(e.x)&&(r.left=e.x*l+s.left),O(e.y)&&(r.top=e.y*l+s.top),O(e.width)&&(r.width=e.width*l),O(e.height)&&(r.height=e.height*l),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?k({},this.containerData):{}},getImageData:function(){return this.sized?k({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&_(["left","top","width","height","naturalWidth","naturalHeight"],function(i){t[i]=e[i]}),t},setCanvasData:function(e){var t=this.canvasData,i=t.aspectRatio;return this.ready&&!this.disabled&&pe(e)&&(O(e.left)&&(t.left=e.left),O(e.top)&&(t.top=e.top),O(e.width)?(t.width=e.width,t.height=e.width/i):O(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this.cropBoxData,i=this.options.aspectRatio,s,r;return this.ready&&this.cropped&&!this.disabled&&pe(e)&&(O(e.left)&&(t.left=e.left),O(e.top)&&(t.top=e.top),O(e.width)&&e.width!==t.width&&(s=!0,t.width=e.width),O(e.height)&&e.height!==t.height&&(r=!0,t.height=e.height),i&&(s?t.height=t.width/i:r&&(t.width=t.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,i=oa(this.image,this.imageData,t,e);if(!this.cropped)return i;var s=this.getData(),r=s.x,n=s.y,l=s.width,u=s.height,h=i.width/Math.floor(t.naturalWidth);h!==1&&(r*=h,n*=h,l*=h,u*=h);var c=l/u,d=se({aspectRatio:c,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=se({aspectRatio:c,width:e.minWidth||0,height:e.minHeight||0},"cover"),y=se({aspectRatio:c,width:e.width||(h!==1?i.width:l),height:e.height||(h!==1?i.height:u)}),v=y.width,E=y.height;v=Math.min(d.width,Math.max(f.width,v)),E=Math.min(d.height,Math.max(f.height,E));var w=document.createElement("canvas"),T=w.getContext("2d");w.width=fe(v),w.height=fe(E),T.fillStyle=e.fillColor||"transparent",T.fillRect(0,0,v,E);var z=e.imageSmoothingEnabled,R=z===void 0?!0:z,U=e.imageSmoothingQuality;T.imageSmoothingEnabled=R,U&&(T.imageSmoothingQuality=U);var F=i.width,g=i.height,x=r,C=n,M,b,P,S,L,V;x<=-l||x>F?(x=0,M=0,P=0,L=0):x<=0?(P=-x,x=0,M=Math.min(F,l+x),L=M):x<=F&&(P=0,M=Math.min(l,F-x),L=M),M<=0||C<=-u||C>g?(C=0,b=0,S=0,V=0):C<=0?(S=-C,C=0,b=Math.min(g,u+C),V=b):C<=g&&(S=0,b=Math.min(u,g-C),V=b);var Y=[x,C,M,b];if(L>0&&V>0){var Q=v/l;Y.push(P*Q,S*Q,L*Q,V*Q)}return T.drawImage.apply(T,[i].concat(Bt(Y.map(function(ne){return Math.floor(fe(ne))})))),w},setAspectRatio:function(e){var t=this.options;return!this.disabled&&!Pe(e)&&(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,i=this.dragBox,s=this.face;if(this.ready&&!this.disabled){var r=e===tt,n=t.movable&&e===Wt;e=r||n?e:Ht,t.dragMode=e,je(i,Ce,e),ue(i,We,r),ue(i,He,n),t.cropBoxMovable||(je(s,Ce,e),ue(s,We,r),ue(s,He,n))}return this}},wa=ee.Cropper,Kt=function(){function a(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ki(this,a),!e||!Vi.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=k({},Tt,pe(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return zi(a,[{key:"init",value:function(){var t=this.element,i=t.tagName.toLowerCase(),s;if(!t[N]){if(t[N]=this,i==="img"){if(this.isImg=!0,s=t.getAttribute("src")||"",this.originalUrl=s,!s)return;s=t.src}else i==="canvas"&&window.HTMLCanvasElement&&(s=t.toDataURL());this.load(s)}}},{key:"load",value:function(t){var i=this;if(t){this.url=t,this.imageData={};var s=this.element,r=this.options;if(!r.rotatable&&!r.scalable&&(r.checkOrientation=!1),!r.checkOrientation||!window.ArrayBuffer){this.clone();return}if(Fi.test(t)){$i.test(t)?this.read(ca(t)):this.clone();return}var n=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=n,n.onabort=l,n.onerror=l,n.ontimeout=l,n.onprogress=function(){n.getResponseHeader("content-type")!==bt&&n.abort()},n.onload=function(){i.read(n.response)},n.onloadend=function(){i.reloading=!1,i.xhr=null},r.checkCrossOrigin&&jt(t)&&s.crossOrigin&&(t=Dt(t)),n.open("GET",t,!0),n.responseType="arraybuffer",n.withCredentials=s.crossOrigin==="use-credentials",n.send()}}},{key:"read",value:function(t){var i=this.options,s=this.imageData,r=pa(t),n=0,l=1,u=1;if(r>1){this.url=da(t,bt);var h=ua(r);n=h.rotate,l=h.scaleX,u=h.scaleY}i.rotatable&&(s.rotate=n),i.scalable&&(s.scaleX=l,s.scaleY=u),this.clone()}},{key:"clone",value:function(){var t=this.element,i=this.url,s=t.crossOrigin,r=i;this.options.checkCrossOrigin&&jt(i)&&(s||(s="anonymous"),r=Dt(i)),this.crossOrigin=s,this.crossOriginUrl=r;var n=document.createElement("img");s&&(n.crossOrigin=s),n.src=r||i,n.alt=t.alt||"The image to crop",this.image=n,n.onload=this.start.bind(this),n.onerror=this.stop.bind(this),X(n,ut),t.parentNode.insertBefore(n,t.nextSibling)}},{key:"start",value:function(){var t=this,i=this.image;i.onload=null,i.onerror=null,this.sizing=!0;var s=ee.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(ee.navigator.userAgent),r=function(h,c){k(t.imageData,{naturalWidth:h,naturalHeight:c,aspectRatio:h/c}),t.initialImageData=k({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(i.naturalWidth&&!s){r(i.naturalWidth,i.naturalHeight);return}var n=document.createElement("img"),l=document.body||document.documentElement;this.sizingImage=n,n.onload=function(){r(n.width,n.height),s||l.removeChild(n)},n.src=i.src,s||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",l.appendChild(n))}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var t=this.element,i=this.options,s=this.image,r=t.parentNode,n=document.createElement("div");n.innerHTML=Gi;var l=n.querySelector(".".concat(N,"-container")),u=l.querySelector(".".concat(N,"-canvas")),h=l.querySelector(".".concat(N,"-drag-box")),c=l.querySelector(".".concat(N,"-crop-box")),d=c.querySelector(".".concat(N,"-face"));this.container=r,this.cropper=l,this.canvas=u,this.dragBox=h,this.cropBox=c,this.viewBox=l.querySelector(".".concat(N,"-view-box")),this.face=d,u.appendChild(s),X(t,q),r.insertBefore(l,t.nextSibling),J(s,ut),this.initPreview(),this.bind(),i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN,i.aspectRatio=Math.max(0,i.aspectRatio)||NaN,i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0,X(c,q),i.guides||X(c.getElementsByClassName("".concat(N,"-dashed")),q),i.center||X(c.getElementsByClassName("".concat(N,"-center")),q),i.background&&X(l,"".concat(N,"-bg")),i.highlight||X(d,_i),i.cropBoxMovable&&(X(d,He),je(d,Ce,et)),i.cropBoxResizable||(X(c.getElementsByClassName("".concat(N,"-line")),q),X(c.getElementsByClassName("".concat(N,"-point")),q)),this.render(),this.ready=!0,this.setDragMode(i.dragMode),i.autoCrop&&this.crop(),this.setData(i.data),G(i.ready)&&K(t,xt,i.ready,{once:!0}),ge(t,xt)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var t=this.cropper.parentNode;t&&t.removeChild(this.cropper),J(this.element,q)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=wa,a}},{key:"setDefaults",value:function(t){k(Tt,pe(t)&&t)}}]),a}();k(Kt.prototype,fa,ga,ma,va,xa,ya);var ie=function(){return ie=Object.assign||function(a){for(var e,t=1,i=arguments.length;t<i;t++)for(var s in e=arguments[t])Object.prototype.hasOwnProperty.call(e,s)&&(a[s]=e[s]);return a},ie.apply(this,arguments)};function Be(a,e){var t={};for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&e.indexOf(i)<0&&(t[i]=a[i]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var s=0;for(i=Object.getOwnPropertySymbols(a);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(a,i[s])&&(t[i[s]]=a[i[s]])}return t}var Ot,Ae={},be={},Et;Et={get exports(){return Ae},set exports(a){Ae=a}},Et.exports=function(){if(Ot)return be;Ot=1;var a=B,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function n(l,u,h){var c,d={},f=null,y=null;for(c in h!==void 0&&(f=""+h),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(y=u.ref),u)i.call(u,c)&&!r.hasOwnProperty(c)&&(d[c]=u[c]);if(l&&l.defaultProps)for(c in u=l.defaultProps)d[c]===void 0&&(d[c]=u[c]);return{$$typeof:e,type:l,key:f,ref:y,props:d,_owner:s.current}}return be.Fragment=t,be.jsx=n,be.jsxs=n,be}();var ba=["aspectRatio","autoCrop","autoCropArea","background","center","checkCrossOrigin","checkOrientation","cropBoxMovable","cropBoxResizable","data","dragMode","guides","highlight","initialAspectRatio","minCanvasHeight","minCanvasWidth","minContainerHeight","minContainerWidth","minCropBoxHeight","minCropBoxWidth","modal","movable","preview","responsive","restore","rotatable","scalable","toggleDragModeOnDblclick","viewMode","wheelZoomRatio","zoomOnTouch","zoomOnWheel","zoomable","cropstart","cropmove","cropend","crop","zoom","ready"],Ta={opacity:0,maxWidth:"100%"},Ca=B.forwardRef(function(a,e){var t=Be(a,[]),i=t.dragMode,s=i===void 0?"crop":i,r=t.src,n=t.style,l=t.className,u=t.crossOrigin,h=t.scaleX,c=t.scaleY,d=t.enable,f=t.zoomTo,y=t.rotateTo,v=t.alt,E=v===void 0?"picture":v,w=t.ready,T=t.onInitialized,z=Be(t,["dragMode","src","style","className","crossOrigin","scaleX","scaleY","enable","zoomTo","rotateTo","alt","ready","onInitialized"]),R={scaleY:c,scaleX:h,enable:d,zoomTo:f,rotateTo:y},U=function(){for(var g=[],x=0;x<arguments.length;x++)g[x]=arguments[x];var C=$.useRef(null);return B.useEffect(function(){g.forEach(function(M){M&&(typeof M=="function"?M(C.current):M.current=C.current)})},[g]),C}(e,$.useRef(null));$.useEffect(function(){var g;!((g=U.current)===null||g===void 0)&&g.cropper&&typeof f=="number"&&U.current.cropper.zoomTo(f)},[t.zoomTo]),$.useEffect(function(){var g;!((g=U.current)===null||g===void 0)&&g.cropper&&r!==void 0&&U.current.cropper.reset().clear().replace(r)},[r]),$.useEffect(function(){if(U.current!==null){var g=new Kt(U.current,ie(ie({dragMode:s},z),{ready:function(x){x.currentTarget!==null&&function(C,M){M===void 0&&(M={});var b=M.enable,P=b===void 0||b,S=M.scaleX,L=S===void 0?1:S,V=M.scaleY,Y=V===void 0?1:V,Q=M.zoomTo,ne=Q===void 0?0:Q,ce=M.rotateTo;P?C.enable():C.disable(),C.scaleX(L),C.scaleY(Y),ce!==void 0&&C.rotateTo(ce),ne>0&&C.zoomTo(ne)}(x.currentTarget.cropper,R),w&&w(x)}}));T&&T(g)}return function(){var x,C;(C=(x=U.current)===null||x===void 0?void 0:x.cropper)===null||C===void 0||C.destroy()}},[U]);var F=function(g){return ba.reduce(function(x,C){var M=x,b=C;return M[b],Be(M,[typeof b=="symbol"?b:b+""])},g)}(ie(ie({},z),{crossOrigin:u,src:r,alt:E}));return Ae.jsx("div",ie({style:n,className:l},{children:Ae.jsx("img",ie({},F,{style:Ta,ref:U}))}))});const ja=a=>{const[e,t]=$.useState(!0),[i,s]=$.useState([]),[r,n]=$.useState(""),[l,u]=$.useState(),[h,c]=$.useState(!1),[d,f]=$.useState(!1),{title:y}=a,{user:v}=a,{buttonText:E}=a,{organization:w}=a;let T;const z=b=>{b.preventDefault();let P;b.dataTransfer?P=b.dataTransfer.files:b.target&&(P=b.target.files);const S=new FileReader;S.onload=()=>{n(S.result)},P[0]instanceof Blob&&S.readAsDataURL(P[0])},R=()=>{l.getCroppedCanvas().toBlob(b=>{if(b===null)return H("error","You must select a picture first!"),!1;const P=r.substring(r.indexOf("/")+1,r.indexOf(";base64")),S=`avatar/${v.owner}/${v.name}.${P}`;return Di(v.owner,v.name,"avatar","CropperDiv",S,b).then(L=>{L.status==="ok"?window.location.href=window.location.pathname:H("error",L.msg)}),!0})},U=()=>{c(!0)},F=()=>{f(!0),R()||f(!1)},g=()=>{c(!1)},x=()=>{T.click()},C=b=>{const P=[];P.push({value:w==null?void 0:w.defaultAvatar});for(let S=0;S<b.length;S++)if(b[S].fileType==="image"){const L=`${b[S].url}`;P.push({value:L})}return P},M=b=>new Promise(P=>{const S=new Image;S.src=b,S.setAttribute("crossOrigin","anonymous"),S.onload=()=>{const L=document.createElement("canvas");L.width=S.width,L.height=S.height,L.getContext("2d").drawImage(S,0,0,S.width,S.height);const Y=L.toDataURL("image/png");P(Y)}});return $.useEffect(()=>{t(!0),ji(v.owner,v.name,"","","","","","").then(b=>{t(!1),s(C(b))})},[]),o.jsxs("div",{children:[o.jsx(I,{type:"default",onClick:U,children:E}),o.jsx(qe,{maskClosable:!1,title:y,open:h,okText:p.t("user:Upload a photo"),confirmLoading:d,onCancel:g,width:600,footer:[o.jsx(I,{block:!0,type:"primary",onClick:F,children:p.t("user:Set new profile picture")},"submit")],children:o.jsxs(m,{style:{margin:"0px auto 60px auto",width:1e3,height:350},children:[o.jsxs(D,{style:{width:"100%",marginBottom:"20px"},children:[o.jsx("input",{style:{display:"none"},ref:b=>T=b,type:"file",accept:"image/*",onChange:z}),o.jsx(I,{block:!0,onClick:x,children:p.t("user:Select a photo...")}),o.jsx(ae,{virtual:!1,style:{width:"100%"},loading:e,placeholder:p.t("user:Please select avatar from resources"),onChange:async b=>{n(await M(b))},options:i,allowClear:!0})]}),o.jsx(Ca,{style:{height:"100%"},initialAspectRatio:1,preview:".img-preview",src:r,viewMode:1,guides:!0,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1,onInitialized:b=>{u(b)}})]})})]})},Da=a=>{const[e,t]=B.useState(!1),[i,s]=B.useState(!1),[r,n]=B.useState(""),[l,u]=B.useState(""),[h,c]=B.useState(""),{user:d}=a,{account:f}=a,y=()=>{t(!0)},v=()=>{t(!1)},E=()=>{if(l===""||h===""){H("error",p.t("user:Empty input!"));return}if(l!==h){H("error",p.t("user:Two passwords you typed do not match."));return}s(!0),ti(d.owner,d.name,r,l).then(T=>{s(!1),T.status==="ok"?(H("success",p.t("user:Password set successfully")),t(!1)):H("error",p.t(`user:${T.msg}`))})},w=d.password!=="";return o.jsxs(D,{children:[o.jsx(I,{type:"default",disabled:a.disabled,onClick:y,children:w?p.t("user:Modify password..."):p.t("user:Set password...")}),o.jsx(qe,{maskClosable:!1,title:p.t("general:Password"),open:e,okText:p.t("user:Set Password"),cancelText:p.t("general:Cancel"),confirmLoading:i,onCancel:v,onOk:E,width:600,children:o.jsxs(m,{style:{margin:"0px auto 40px auto",width:1e3,height:300},children:[w&&!Le(f)?o.jsx(D,{style:{width:"100%",marginBottom:"20px"},children:o.jsx(W.Password,{addonBefore:p.t("user:Old Password"),placeholder:p.t("user:input password"),onChange:T=>n(T.target.value)})}):null,o.jsx(D,{style:{width:"100%",marginBottom:"20px"},children:o.jsx(W.Password,{addonBefore:p.t("user:New Password"),placeholder:p.t("user:input password"),onChange:T=>u(T.target.value)})}),o.jsx(D,{style:{width:"100%",marginBottom:"20px"},children:o.jsx(W.Password,{addonBefore:p.t("user:Re-enter New"),placeholder:p.t("user:input password"),onChange:T=>c(T.target.value)})})]})})]})},Mt=a=>{const[e,t]=B.useState(!1),[i,s]=B.useState(!1),[r,n]=B.useState(""),[l,u]=B.useState(""),{buttonText:h,destType:c,application:d,countryCode:f}=a,y=()=>{t(!0)},v=()=>{t(!1)},E=()=>{if(r===""){c==="phone"?H("error",p.t("user:Phone cannot be empty")):H("error",p.t("user:Email cannot be empty"));return}if(l===""){H("error",p.t("code:Empty code"));return}s(!0),si(r,c,l).then(T=>{T.status==="ok"?(H("success",p.t("user:Email/phone reset successfully")),window.location.reload()):(H("error",p.t("user:"+T.msg)),s(!1))})};let w="";return c==="email"?w=p.t("user:Input your email"):c==="phone"&&(w=p.t("user:Input your phone number")),o.jsxs(D,{children:[o.jsx(I,{type:"default",onClick:y,children:h}),o.jsx(qe,{maskClosable:!1,title:h,open:e,okText:h,cancelText:p.t("general:Cancel"),confirmLoading:i,onCancel:v,onOk:E,width:600,children:o.jsxs(m,{style:{margin:"0px auto 40px auto",width:1e3,height:300},children:[o.jsx(D,{style:{width:"100%",marginBottom:"20px"},children:o.jsx(W,{addonBefore:c==="email"?p.t("user:New Email"):p.t("user:New phone"),prefix:c==="email"?o.jsxs(B.Fragment,{children:[o.jsx(Ri,{}),"  "]}):o.jsxs(B.Fragment,{children:[o.jsx(Ni,{}),"  ",f!==""?"+":null,ii(f)," "]}),placeholder:w,onChange:T=>n(T.target.value)})}),o.jsx(D,{style:{width:"100%",marginBottom:"20px"},children:o.jsx(ai,{textBefore:p.t("code:Code you received"),onChange:u,method:"reset",onButtonClickArgs:[r,c,ri(d)],application:d})})]})})]})};class Oa extends B.Component{constructor(e){super(e),this.state={classes:e,addressOptions:[],affiliationOptions:[]}}renderIdp(e,t,i){const s=i.provider,r=e.name;return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:this.props.labelSpan,children:[ni(s),o.jsx("span",{style:{marginLeft:"5px"},children:`${s.type}:`})]}),o.jsx(m,{span:24-this.props.labelSpan,style:{marginTop:"5px"},children:o.jsx("span",{style:{width:this.props.labelSpan===3?"300px":"130px",display:j()?"inline":"inline-block"},children:r})})]},s.name)}render(){return this.renderIdp(this.props.user,this.props.application,this.props.providerItem)}}class Ea extends B.Component{deleteRow(e,t){e=Ke(e,t),this.props.updateTable(e)}registerWebAuthn(){oi().then(e=>{e.status==="ok"?H("success","Successfully added webauthn credentials"):H("error",e.msg),this.props.refresh()}).catch(e=>{H("error",`${p.t("general:Failed to connect to server")}: ${e}`)})}render(){const e=[{title:p.t("general:Name"),dataIndex:"ID",key:"ID"},{title:p.t("general:Action"),key:"action",width:"170px",render:(t,i,s)=>o.jsx(I,{style:{marginTop:"5px",marginBottom:"5px",marginRight:"5px"},type:"primary",danger:!0,onClick:()=>{this.deleteRow(this.props.table,s)},children:p.t("general:Delete")})}];return o.jsx(Ze,{rowKey:"ID",columns:e,dataSource:this.props.table,size:"middle",bordered:!0,pagination:!1,title:()=>o.jsxs("div",{children:[p.t("user:WebAuthn credentials"),"    ",o.jsx(I,{disabled:!this.props.isSelf,style:{marginRight:"5px"},type:"primary",size:"small",onClick:()=>{this.registerWebAuthn()},children:p.t("general:Add")})]})})}}const{Option:Ma}=ae;var St;class Sa extends B.Component{constructor(t){super(t);me(this,"count",((St=this.props.table)==null?void 0:St.length)??0);this.state={classes:t,managedAccounts:this.props.table!==null?this.props.table.map((i,s)=>(i.key=s,i)):[]}}updateTable(t){this.setState({managedAccounts:t}),this.props.onUpdateTable([...t].map(i=>{const s=Rt(i);return delete s.key,s}))}updateField(t,i,s,r){t[i][s]=r,this.updateTable(t)}addRow(t){const i={key:this.count,application:"",username:"",password:""};t==null&&(t=[]),this.count+=1,t=Nt(t,i),this.updateTable(t)}deleteRow(t,i){t=Ke(t,i),this.updateTable(t)}upRow(t,i){t=ot(t,i-1,i),this.updateTable(t)}downRow(t,i){t=ot(t,i,i+1),this.updateTable(t)}renderTable(t){const i=[{title:p.t("general:Application"),dataIndex:"application",key:"application",render:(s,r,n)=>{const l=this.props.applications;return o.jsx(ae,{virtual:!1,style:{width:"100%"},value:s,onChange:u=>{this.updateField(t,n,"application",u)},children:l.map((u,h)=>o.jsx(Ma,{value:u.name,children:u.name},h))})}},{title:p.t("signup:Username"),dataIndex:"username",key:"username",width:"420px",render:(s,r,n)=>o.jsx(W,{defaultValue:s,onChange:l=>{this.updateField(t,n,"username",l.target.value)}})},{title:p.t("general:Password"),dataIndex:"password",key:"password",width:"420px",render:(s,r,n)=>o.jsx(W,{defaultValue:s,onChange:l=>{this.updateField(t,n,"password",l.target.value)}})},{title:p.t("general:Action"),key:"action",width:"100px",render:(s,r,n)=>o.jsxs("div",{children:[o.jsx(ke,{placement:"bottomLeft",title:p.t("general:Up"),children:o.jsx(I,{style:{marginRight:"5px"},disabled:n===0,icon:o.jsx(Oi,{}),size:"small",onClick:()=>this.upRow(t,n)})}),o.jsx(ke,{placement:"topLeft",title:p.t("general:Down"),children:o.jsx(I,{style:{marginRight:"5px"},disabled:n===t.length-1,icon:o.jsx(hi,{}),size:"small",onClick:()=>this.downRow(t,n)})}),o.jsx(ke,{placement:"topLeft",title:p.t("general:Delete"),children:o.jsx(I,{icon:o.jsx(kt,{}),size:"small",onClick:()=>this.deleteRow(t,n)})})]})}];return o.jsx(Ze,{scroll:{x:"max-content"},rowKey:"key",columns:i,dataSource:t,size:"middle",bordered:!0,pagination:!1,title:()=>o.jsxs("div",{children:[this.props.title,"    ",o.jsx(I,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:()=>this.addRow(t),children:p.t("general:Add")})]})})}render(){return o.jsx("div",{children:o.jsx(D,{style:{marginTop:"20px"},children:o.jsx(m,{span:24,children:this.renderTable(this.state.managedAccounts)})})})}}class Aa extends B.Component{constructor(t){super(t);me(this,"page",1);me(this,"pageSize",10);me(this,"count",this.props.properties!==null?Object.entries(this.props.properties).length:0);this.state={properties:[]},this.props.properties!==null&&Object.entries(this.props.properties).map((i,s)=>{this.state.properties.push({key:s,name:i[0],value:i[1]})})}updateTable(t){this.setState({properties:t});const i={};t.map(s=>{i[s.name]=s.value}),this.props.onUpdateTable(i)}addRow(t){const i={key:this.count,name:"",value:""};t===void 0&&(t=[]),t=Nt(t,i),this.count=this.count+1,this.updateTable(t)}deleteRow(t,i){t=Ke(t,this.getIndex(i)),this.updateTable(t)}getIndex(t){return t+(this.page-1)*this.pageSize}updateField(t,i,s,r){t[this.getIndex(i)][s]=r,this.updateTable(t)}renderTable(t){const i=[{title:p.t("user:Keys"),dataIndex:"name",width:"200px",render:(s,r,n)=>o.jsx(W,{value:s,onChange:l=>{this.updateField(t,n,"name",l.target.value)}})},{title:p.t("user:Values"),dataIndex:"value",width:"200px",render:(s,r,n)=>o.jsx(W,{value:s,onChange:l=>{this.updateField(t,n,"value",l.target.value)}})},{title:p.t("general:Action"),dataIndex:"operation",width:"20px",render:(s,r,n)=>o.jsx(I,{icon:o.jsx(kt,{}),size:"small",onClick:()=>this.deleteRow(t,n)})}];return o.jsx(Ze,{title:()=>o.jsx("div",{children:o.jsx(I,{style:{marginRight:"5px"},type:"primary",size:"small",onClick:()=>this.addRow(t),children:p.t("general:Add")})}),pagination:{defaultPageSize:this.pageSize,onChange:s=>{this.page=s}},columns:i,dataSource:t,rowKey:"key",size:"middle",bordered:!0})}render(){return o.jsx(B.Fragment,{children:this.renderTable(this.state.properties)})}}const{Option:Ra}=ae;class Wa extends B.Component{constructor(e){super(e),this.state={classes:e,organizationName:e.organizationName!==void 0?e.organizationName:e.match.params.organizationName,userName:e.userName!==void 0?e.userName:e.match.params.userName,user:null,application:null,organizations:[],applications:[],mode:e.location.mode!==void 0?e.location.mode:"edit",loading:!0,returnUrl:null}}UNSAFE_componentWillMount(){this.getUser(),this.getOrganizations(),this.getApplicationsByOrganization(this.state.organizationName),this.getUserApplication(),this.setReturnUrl()}getUser(){li(this.state.organizationName,this.state.userName).then(e=>{(e.status===null||e.status!=="error")&&this.setState({user:e}),this.setState({loading:!1})})}getOrganizations(){ci("admin").then(e=>{this.setState({organizations:e.msg===void 0?e:[]})})}getApplicationsByOrganization(e){di("admin",e).then(t=>{this.setState({applications:t.msg===void 0?t:[]})})}getUserApplication(){pi(this.state.organizationName,this.state.userName).then(e=>{this.setState({application:e})})}setReturnUrl(){const t=new URLSearchParams(this.props.location.search).get("returnUrl");t!==null&&this.setState({returnUrl:t})}parseUserField(e,t){return t}updateUserField(e,t){t=this.parseUserField(e,t);const i=this.state.user;i[e]=t,this.setState({user:i})}unlinked(){this.getUser()}isSelf(){var e;return this.state.user.id===((e=this.props.account)==null?void 0:e.id)}isSelfOrAdmin(){return this.isSelf()||Le(this.props.account)}getCountryCode(){return this.props.account.countryCode}renderAccountItem(e){var s,r,n,l,u;if(!e.visible)return null;const t=Le(this.props.account);if(e.viewRule==="Self"){if(!this.isSelfOrAdmin())return null}else if(e.viewRule==="Admin"&&!t)return null;let i=!1;if(e.modifyRule==="Self"?this.isSelfOrAdmin()||(i=!0):e.modifyRule==="Admin"?t||(i=!0):e.modifyRule==="Immutable"&&(i=!0),e.name==="Organization")return o.jsxs(D,{style:{marginTop:"10px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Organization"),p.t("general:Organization - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(ae,{virtual:!1,style:{width:"100%"},disabled:i,value:this.state.user.owner,onChange:h=>{this.getApplicationsByOrganization(h),this.updateUserField("owner",h)},children:this.state.organizations.map((h,c)=>o.jsx(Ra,{value:h.name,children:h.name},c))})})]});if(e.name==="ID")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A("ID",p.t("general:ID - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(W,{value:this.state.user.id,disabled:i})})]});if(e.name==="Name")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Name"),p.t("general:Name - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(W,{value:this.state.user.name,disabled:i,onChange:h=>{this.updateUserField("name",h.target.value)}})})]});if(e.name==="Display name")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Display name"),p.t("general:Display name - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(W,{value:this.state.user.displayName,onChange:h=>{this.updateUserField("displayName",h.target.value)}})})]});if(e.name==="Avatar")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Avatar"),p.t("general:Avatar - Tooltip"))," :"]}),o.jsxs(m,{span:22,children:[o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[p.t("general:Preview"),":"]}),o.jsx(m,{span:22,children:o.jsx("a",{target:"_blank",rel:"noreferrer",href:this.state.user.avatar,children:o.jsx("img",{src:this.state.user.avatar,alt:this.state.user.avatar,height:90,style:{marginBottom:"20px"}})})})]}),o.jsx(D,{style:{marginTop:"20px"},children:o.jsx(ja,{buttonText:`${p.t("user:Upload a photo")}...`,title:p.t("user:Upload a photo"),user:this.state.user,organization:this.state.organizations.find(h=>h.name===this.state.organizationName)})})]})]});if(e.name==="User type")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:User type"),p.t("general:User type - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(ae,{virtual:!1,style:{width:"100%"},value:this.state.user.type,onChange:h=>{this.updateUserField("type",h)},options:["normal-user"].map(h=>ze(h,h))})})]});if(e.name==="Password")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Password"),p.t("general:Password - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(Da,{user:this.state.user,account:this.props.account,disabled:i})})]});if(e.name==="Email")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Email"),p.t("general:Email - Tooltip"))," :"]}),o.jsx(m,{style:{paddingRight:"20px"},span:11,children:o.jsx(W,{value:this.state.user.email,style:{width:"280Px"},disabled:ht(this.props.account)?i:!0,onChange:h=>{this.updateUserField("email",h.target.value)}})}),o.jsx(m,{span:j()?22:11,children:this.isSelf()?o.jsx(Mt,{application:this.state.application,disabled:i,buttonText:p.t("user:Reset Email..."),destType:"email"}):null})]});if(e.name==="Phone")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Phone"),p.t("general:Phone - Tooltip"))," :"]}),o.jsx(m,{style:{paddingRight:"20px"},span:11,children:o.jsxs(W.Group,{compact:!0,style:{width:"280Px"},children:[o.jsx(ui,{style:{width:"30%"},value:this.state.user.countryCode,onChange:h=>{this.updateUserField("countryCode",h)},countryCodes:(s=this.state.application)==null?void 0:s.organizationObj.countryCodes}),o.jsx(W,{value:this.state.user.phone,style:{width:"70%"},disabled:ht(this.props.account)?i:!0,onChange:h=>{this.updateUserField("phone",h.target.value)}})]})}),o.jsx(m,{span:j()?24:11,children:this.isSelf()?o.jsx(Mt,{application:this.state.application,countryCode:this.getCountryCode(),disabled:i,buttonText:p.t("user:Reset Phone..."),destType:"phone"}):null})]});if(e.name==="Country/Region")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Country/Region"),p.t("user:Country/Region - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(fi,{defaultValue:this.state.user.region,onChange:h=>{this.updateUserField("region",h)}})})]});if(e.name==="Location")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Location"),p.t("user:Location - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(W,{value:this.state.user.location,onChange:h=>{this.updateUserField("location",h.target.value)}})})]});if(e.name==="Affiliation")return this.state.application===null||this.state.user===null?null:o.jsx(gi,{labelSpan:j()?22:2,application:this.state.application,user:this.state.user,onUpdateUserField:(h,c)=>this.updateUserField(h,c)});if(e.name==="Title")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Title"),p.t("user:Title - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(W,{value:this.state.user.title,onChange:h=>{this.updateUserField("title",h.target.value)}})})]});if(e.name==="Homepage")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Homepage"),p.t("user:Homepage - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(W,{value:this.state.user.homepage,onChange:h=>{this.updateUserField("homepage",h.target.value)}})})]});if(e.name==="Bio")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Bio"),p.t("user:Bio - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(W,{value:this.state.user.bio,onChange:h=>{this.updateUserField("bio",h.target.value)}})})]});if(e.name==="Tag")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Tag"),p.t("user:Tag - Tooltip"))," :"]}),o.jsx(m,{span:22,children:((n=(r=this.state.application)==null?void 0:r.organizationObj.tags)==null?void 0:n.length)>0?o.jsx(ae,{virtual:!1,style:{width:"100%"},value:this.state.user.tag,onChange:h=>{this.updateUserField("tag",h)},options:(l=this.state.application.organizationObj.tags)==null?void 0:l.map(h=>{const c=h.split("|"),d=c[0],f=mi()!=="zh"?c[0]:c[1];return ze(f,d)})}):o.jsx(W,{value:this.state.user.tag,onChange:h=>{this.updateUserField("tag",h.target.value)}})})]});if(e.name==="Signup application")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Signup application"),p.t("general:Signup application - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(ae,{virtual:!1,style:{width:"100%"},disabled:i,value:this.state.user.signupApplication,onChange:h=>{this.updateUserField("signupApplication",h)},options:this.state.applications.map(h=>ze(h.name,h.name))})})]});if(e.name==="Roles")return o.jsxs(D,{style:{marginTop:"20px",alignItems:"center"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Roles"),p.t("general:Roles - Tooltip"))," :"]}),o.jsx(m,{span:22,children:lt(this.state.user.roles.map(h=>h.name))})]});if(e.name==="Permissions")return o.jsxs(D,{style:{marginTop:"20px",alignItems:"center"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("general:Permissions"),p.t("general:Permissions - Tooltip"))," :"]}),o.jsx(m,{span:22,children:lt(this.state.user.permissions.map(h=>h.name))})]});if(e.name==="3rd-party logins")return this.isSelfOrAdmin()?o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:3rd-party logins"),p.t("user:3rd-party logins - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx("div",{style:{marginBottom:20},children:this.state.application===null||this.state.user===null?null:(u=this.state.application)==null?void 0:u.providers.filter(h=>vi(h)).map(h=>h.provider.category==="OAuth"?o.jsx(xi,{labelSpan:j()?10:3,user:this.state.user,application:this.state.application,providerItem:h,account:this.props.account,onUnlinked:()=>this.unlinked()},h.name):o.jsx(Oa,{labelSpan:j()?10:3,user:this.state.user,application:this.state.application,providerItem:h,onUnlinked:()=>this.unlinked()},h.name))})})]}):null;if(e.name==="Properties")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Properties"),p.t("user:Properties - Tooltip"))," :"]}),o.jsx(m,{span:22,children:o.jsx(Aa,{properties:this.state.user.properties,onUpdateTable:h=>{this.updateUserField("properties",h)}})})]});if(e.name==="Is admin")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Is admin"),p.t("user:Is admin - Tooltip"))," :"]}),o.jsx(m,{span:j()?22:2,children:o.jsx(De,{disabled:i,checked:this.state.user.isAdmin,onChange:h=>{this.updateUserField("isAdmin",h)}})})]});if(e.name==="Is globalThis admin")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Is globalThis admin"),p.t("user:Is globalThis admin - Tooltip"))," :"]}),o.jsx(m,{span:j()?22:2,children:o.jsx(De,{disabled:i,checked:this.state.user.isGlobalAdmin,onChange:h=>{this.updateUserField("isGlobalAdmin",h)}})})]});if(e.name==="Is forbidden")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Is forbidden"),p.t("user:Is forbidden - Tooltip"))," :"]}),o.jsx(m,{span:j()?22:2,children:o.jsx(De,{checked:this.state.user.isForbidden,onChange:h=>{this.updateUserField("isForbidden",h)}})})]});if(e.name==="Is deleted")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Is deleted"),p.t("user:Is deleted - Tooltip"))," :"]}),o.jsx(m,{span:j()?22:2,children:o.jsx(De,{checked:this.state.user.isDeleted,onChange:h=>{this.updateUserField("isDeleted",h)}})})]});if(e.name==="WebAuthn credentials")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:WebAuthn credentials"),p.t("user:WebAuthn credentials"))," :"]}),o.jsx(m,{span:22,children:o.jsx(Ea,{isSelf:this.isSelf(),table:this.state.user.webauthnCredentials,updateTable:h=>{this.updateUserField("webauthnCredentials",h)},refresh:this.getUser.bind(this)})})]});if(e.name==="Managed accounts")return o.jsxs(D,{style:{marginTop:"20px"},children:[o.jsxs(m,{style:{marginTop:"5px"},span:j()?22:2,children:[A(p.t("user:Managed accounts"),p.t("user:Managed accounts"))," :"]}),o.jsx(m,{span:22,children:o.jsx(Sa,{title:p.t("user:Managed accounts"),table:this.state.user.managedAccounts,onUpdateTable:h=>{this.updateUserField("managedAccounts",h)},applications:this.state.applications})})]})}renderUser(){var e,t;return o.jsx(yi,{size:"small",title:o.jsxs("div",{children:[this.state.mode==="add"?p.t("user:New User"):p.t("user:Edit User"),"    ",o.jsx(I,{onClick:()=>this.submitUserEdit(!1),children:p.t("general:Save")}),o.jsx(I,{style:{marginLeft:"20px"},type:"primary",onClick:()=>this.submitUserEdit(!0),children:p.t("general:Save & Exit")}),this.state.mode==="add"?o.jsx(I,{style:{marginLeft:"20px"},onClick:()=>this.deleteUser(),children:p.t("general:Cancel")}):null]}),style:j()?{margin:"5px"}:{},type:"inner",children:(t=(e=this.state.application)==null?void 0:e.organizationObj.accountItems)==null?void 0:t.map(i=>o.jsx(B.Fragment,{children:this.renderAccountItem(i)},i.name))})}submitUserEdit(e){const t=Rt(this.state.user);wi(this.state.organizationName,this.state.userName,t).then(i=>{i.status==="ok"?(H("success",p.t("general:Successfully saved")),this.setState({organizationName:this.state.user.owner,userName:this.state.user.name}),this.props.history!==void 0?e?this.props.history.push("/users"):this.props.history.push(`/users/${this.state.user.owner}/${this.state.user.name}`):e&&this.state.returnUrl&&(window.location.href=this.state.returnUrl)):(H("error",`${p.t("general:Failed to save")}: ${i.msg}`),this.updateUserField("owner",this.state.organizationName),this.updateUserField("name",this.state.userName))}).catch(i=>{H("error",`${p.t("general:Failed to connect to server")}: ${i}`)})}deleteUser(){bi(this.state.user).then(e=>{e.status==="ok"?this.props.history.push("/users"):H("error",`${p.t("general:Failed to delete")}: ${e.msg}`)}).catch(e=>{H("error",`${p.t("general:Failed to connect to server")}: ${e}`)})}render(){return o.jsxs("div",{children:[this.state.loading?o.jsx(Ti,{size:"large",style:{marginLeft:"50%",marginTop:"10%"}}):this.state.user!==null?this.renderUser():o.jsx(Ci,{status:"404",title:"404 NOT FOUND",subTitle:p.t("general:Sorry, the user you visited does not exist or you are not authorized to access this user."),extra:o.jsx("a",{href:"/",children:o.jsx(I,{type:"primary",children:p.t("general:Back Home")})})}),this.state.user===null?null:o.jsxs("div",{style:{marginTop:"20px",marginLeft:"40px"},children:[o.jsx(I,{size:"large",onClick:()=>this.submitUserEdit(!1),children:p.t("general:Save")}),o.jsx(I,{style:{marginLeft:"20px"},type:"primary",size:"large",onClick:()=>this.submitUserEdit(!0),children:p.t("general:Save & Exit")}),this.state.mode==="add"?o.jsx(I,{style:{marginLeft:"20px"},size:"large",onClick:()=>this.deleteUser(),children:p.t("general:Cancel")}):null]})]})}}export{Wa as default};
